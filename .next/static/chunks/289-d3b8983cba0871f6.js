(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[289],{2693:function(t,e,n){"use strict";n.r(e),n.d(e,{AgeGenderNet:function(){return eu},BoundingBox:function(){return j},Box:function(){return I},ComposableTask:function(){return eZ},ComputeAllFaceDescriptorsTask:function(){return nC},ComputeFaceDescriptorsTaskBase:function(){return nk},ComputeSingleFaceDescriptorTask:function(){return nA},DetectAllFaceLandmarksTask:function(){return nO},DetectAllFacesTask:function(){return nI},DetectFaceLandmarksTaskBase:function(){return nD},DetectFacesTaskBase:function(){return nB},DetectSingleFaceLandmarksTask:function(){return nL},DetectSingleFaceTask:function(){return nj},Dimensions:function(){return w},FACE_EXPRESSION_LABELS:function(){return t3},FaceDetection:function(){return N},FaceDetectionNet:function(){return eL},FaceExpressionNet:function(){return t8},FaceExpressions:function(){return t6},FaceLandmark68Net:function(){return el},FaceLandmark68TinyNet:function(){return ep},FaceLandmarkNet:function(){return ed},FaceLandmarks:function(){return q},FaceLandmarks5:function(){return X},FaceLandmarks68:function(){return $},FaceMatch:function(){return K},FaceMatcher:function(){return nH},FaceRecognitionNet:function(){return ew},Gender:function(){return c},LabeledBox:function(){return Q},LabeledFaceDescriptors:function(){return tt},Mtcnn:function(){return e5},MtcnnOptions:function(){return eF},NetInput:function(){return tS},NeuralNetwork:function(){return tN},ObjectDetection:function(){return R},Point:function(){return B},PredictedBox:function(){return te},Rect:function(){return Z},SsdMobilenetv1:function(){return eA},SsdMobilenetv1Options:function(){return eC},TinyFaceDetector:function(){return e6},TinyFaceDetectorOptions:function(){return eJ},TinyYolov2:function(){return eH},TinyYolov2Options:function(){return eV},TinyYolov2SizeType:function(){return u},allFaces:function(){return nV},allFacesMtcnn:function(){return nU},allFacesSsdMobilenetv1:function(){return nW},allFacesTinyYolov2:function(){return nz},awaitMediaLoaded:function(){return tw},bufferToImage:function(){return t_},computeFaceDescriptor:function(){return no},createCanvas:function(){return tE},createCanvasFromMedia:function(){return tP},createFaceDetectionNet:function(){return eO},createFaceRecognitionNet:function(){return e_},createMtcnn:function(){return nY},createSsdMobilenetv1:function(){return eD},createTinyFaceDetector:function(){return nJ},createTinyYolov2:function(){return eY},detectAllFaces:function(){return nN},detectFaceLandmarks:function(){return nn},detectFaceLandmarksTiny:function(){return nr},detectLandmarks:function(){return ny},detectSingleFace:function(){return nR},draw:function(){return l},env:function(){return tl},euclideanDistance:function(){return nG},extendWithAge:function(){return eP},extendWithFaceDescriptor:function(){return ex},extendWithFaceDetection:function(){return tr},extendWithFaceExpressions:function(){return t9},extendWithFaceLandmarks:function(){return en},extendWithGender:function(){return eT},extractFaceTensors:function(){return tA},extractFaces:function(){return tC},fetchImage:function(){return tO},fetchJson:function(){return tL},fetchNetWeights:function(){return tB},fetchOrThrow:function(){return tD},getContext2dOrThrow:function(){return tp},getMediaDimensions:function(){return tx},imageTensorToCanvas:function(){return tM},imageToSquare:function(){return tF},inverseSigmoid:function(){return J},iou:function(){return W},isMediaElement:function(){return tT},isMediaLoaded:function(){return tb},isWithAge:function(){return eE},isWithFaceDetection:function(){return tn},isWithFaceExpressions:function(){return t7},isWithFaceLandmarks:function(){return ee},isWithGender:function(){return eM},loadAgeGenderModel:function(){return nv},loadFaceDetectionModel:function(){return nm},loadFaceExpressionModel:function(){return nd},loadFaceLandmarkModel:function(){return nl},loadFaceLandmarkTinyModel:function(){return nh},loadFaceRecognitionModel:function(){return np},loadMtcnnModel:function(){return nu},loadSsdMobilenetv1Model:function(){return ns},loadTinyFaceDetectorModel:function(){return nc},loadTinyYolov2Model:function(){return nf},loadWeightMap:function(){return tj},locateFaces:function(){return ng},matchDimensions:function(){return tR},minBbox:function(){return z},mtcnn:function(){return ne},nets:function(){return e8},nonMaxSuppression:function(){return U},normalize:function(){return V},padToSquare:function(){return G},predictAgeAndGender:function(){return na},recognizeFaceExpressions:function(){return ni},resizeResults:function(){return function t(e,n){var r=new w(n.width,n.height),o=r.width,i=r.height;if(o<=0||i<=0)throw Error("resizeResults - invalid dimensions: "+JSON.stringify({width:o,height:i}));if(Array.isArray(e))return e.map(function(e){return t(e,{width:o,height:i})});if(ee(e)){var a=e.detection.forSize(o,i),s=e.unshiftedLandmarks.forSize(a.box.width,a.box.height);return en(tr(e,a),s)}return tn(e)?tr(e,e.detection.forSize(o,i)):e instanceof q||e instanceof N?e.forSize(o,i):e}},resolveInput:function(){return th},shuffleArray:function(){return H},sigmoid:function(){return Y},ssdMobilenetv1:function(){return e7},tf:function(){return h},tinyFaceDetector:function(){return e9},tinyYolov2:function(){return nt},toNetInput:function(){return tk},utils:function(){return f},validateConfig:function(){return eN}});var r,o,i,a,s,c,u,f={};n.r(f),n.d(f,{computeReshapedDimensions:function(){return C},getCenterPoint:function(){return A},isDimensions:function(){return k},isEven:function(){return F},isFloat:function(){return T},isTensor:function(){return _},isTensor1D:function(){return x},isTensor2D:function(){return E},isTensor3D:function(){return P},isTensor4D:function(){return M},isValidNumber:function(){return O},isValidProbablitiy:function(){return L},range:function(){return D},round:function(){return S}});var l={};n.r(l),n.d(l,{AnchorPosition:function(){return s},DrawBox:function(){return tg},DrawBoxOptions:function(){return tm},DrawFaceLandmarks:function(){return eo},DrawFaceLandmarksOptions:function(){return er},DrawTextField:function(){return tv},DrawTextFieldOptions:function(){return td},drawContour:function(){return p},drawDetections:function(){return ty},drawFaceExpressions:function(){return et},drawFaceLandmarks:function(){return ei}});var h=n(6449);function p(t,e,n){if(void 0===n&&(n=!1),t.beginPath(),e.slice(1).forEach(function(n,r){var o=n.x,i=n.y,a=e[r];t.moveTo(a.x,a.y),t.lineTo(o,i)}),n){var r=e[e.length-1],o=e[0];if(!r||!o)return;t.moveTo(r.x,r.y),t.lineTo(o.x,o.y)}t.stroke()}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var d=function(t,e){return(d=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function v(t,e){function n(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var m=function(){return(m=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function g(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function s(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})}function y(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function b(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),o=0,e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var w=function(){function t(t,e){if(!O(t)||!O(e))throw Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:e}));this._width=t,this._height=e}return Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),t.prototype.reverse=function(){return new t(1/this.width,1/this.height)},t}();function _(t,e){return t instanceof h.Tensor&&t.shape.length===e}function x(t){return _(t,1)}function E(t){return _(t,2)}function P(t){return _(t,3)}function M(t){return _(t,4)}function T(t){return t%1!=0}function F(t){return t%2==0}function S(t,e){void 0===e&&(e=2);var n=Math.pow(10,e);return Math.floor(t*n)/n}function k(t){return t&&t.width&&t.height}function C(t,e){var n=t.width,r=t.height,o=e/Math.max(r,n);return new w(Math.round(n*o),Math.round(r*o))}function A(t){return t.reduce(function(t,e){return t.add(e)},new B(0,0)).div(new B(t.length,t.length))}function D(t,e,n){return Array(t).fill(0).map(function(t,r){return e+r*n})}function O(t){return!!t&&t!==1/0&&t!==-1/0&&!isNaN(t)||0===t}function L(t){return O(t)&&0<=t&&t<=1}var B=function(){function t(t,e){this._x=t,this._y=e}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.sub=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.mul=function(e){return new t(this.x*e.x,this.y*e.y)},t.prototype.div=function(e){return new t(this.x/e.x,this.y/e.y)},t.prototype.abs=function(){return new t(Math.abs(this.x),Math.abs(this.y))},t.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y))},t}(),I=function(){function t(e,n){void 0===n&&(n=!0);var r=e||{},o=[r.left,r.top,r.right,r.bottom].every(O),i=[r.x,r.y,r.width,r.height].every(O);if(!i&&!o)throw Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var a=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=a[0],c=a[1],u=a[2],f=a[3];t.assertIsValidBox({x:s,y:c,width:u,height:f},"Box.constructor",n),this._x=s,this._y=c,this._width=u,this._height=f}return t.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(O)},t.assertIsValidBox=function(e,n,r){if(void 0===r&&(r=!1),!t.isRect(e))throw Error(n+" - invalid box: "+JSON.stringify(e)+", expected object with properties x, y, width, height");if(!r&&(e.width<0||e.height<0))throw Error(n+" - width ("+e.width+") and height ("+e.height+") must be positive numbers")},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topLeft",{get:function(){return new B(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topRight",{get:function(){return new B(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomLeft",{get:function(){return new B(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomRight",{get:function(){return new B(this.right,this.bottom)},enumerable:!0,configurable:!0}),t.prototype.round=function(){var e=[this.x,this.y,this.width,this.height].map(function(t){return Math.round(t)});return new t({x:e[0],y:e[1],width:e[2],height:e[3]})},t.prototype.floor=function(){var e=[this.x,this.y,this.width,this.height].map(function(t){return Math.floor(t)});return new t({x:e[0],y:e[1],width:e[2],height:e[3]})},t.prototype.toSquare=function(){var e=this.x,n=this.y,r=this.width,o=this.height,i=Math.abs(r-o);return r<o&&(e-=i/2,r+=i),o<r&&(n-=i/2,o+=i),new t({x:e,y:n,width:r,height:o})},t.prototype.rescale=function(e){var n=k(e)?e.width:e,r=k(e)?e.height:e;return new t({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},t.prototype.pad=function(e,n){var r=[this.x-e/2,this.y-n/2,this.width+e,this.height+n];return new t({x:r[0],y:r[1],width:r[2],height:r[3]})},t.prototype.clipAtImageBorders=function(e,n){var r=this.x,o=this.y,i=this.right,a=this.bottom,s=Math.max(r,0),c=Math.max(o,0);return new t({x:s,y:c,width:Math.min(i-s,e-s),height:Math.min(a-c,n-c)}).floor()},t.prototype.shift=function(e,n){var r=this.width,o=this.height;return new t({x:this.x+e,y:this.y+n,width:r,height:o})},t.prototype.padAtBorders=function(t,e){var n=this.width+1,r=this.height+1,o=n,i=r,a=this.left,s=this.top,c=this.right,u=this.bottom;return c>e&&(o=-c+e+n,c=e),u>t&&(i=-u+t+r,u=t),a<1&&(i=2-a,a=1),s<1&&(i=2-s,s=1),{dy:1,edy:i,dx:1,edx:o,y:s,ey:u,x:a,ex:c,w:n,h:r}},t.prototype.calibrate=function(e){return new t({left:this.left+e.left*this.width,top:this.top+e.top*this.height,right:this.right+e.right*this.width,bottom:this.bottom+e.bottom*this.height}).toSquare().round()},t}(),j=function(t){function e(e,n,r,o,i){return void 0===i&&(i=!1),t.call(this,{left:e,top:n,right:r,bottom:o},i)||this}return v(e,t),e}(I),R=function(){function t(t,e,n,r,o){this._imageDims=new w(o.width,o.height),this._score=t,this._classScore=e,this._className=n,this._box=new I(r).rescale(this._imageDims)}return Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativeBox",{get:function(){return new I(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),t.prototype.forSize=function(e,n){return new t(this.score,this.classScore,this.className,this.relativeBox,{width:e,height:n})},t}(),N=function(t){function e(e,n,r){return t.call(this,e,e,"",n,r)||this}return v(e,t),e.prototype.forSize=function(n,r){var o=t.prototype.forSize.call(this,n,r);return new e(o.score,o.relativeBox,o.imageDims)},e}(R);function W(t,e,n){void 0===n&&(n=!0);var r=Math.max(0,Math.min(t.right,e.right)-Math.max(t.left,e.left))*Math.max(0,Math.min(t.bottom,e.bottom)-Math.max(t.top,e.top));return n?r/(t.area+e.area-r):r/Math.min(t.area,e.area)}function z(t){var e=t.map(function(t){return t.x}),n=t.map(function(t){return t.y});return new j(e.reduce(function(t,e){return e<t?e:t},1/0),n.reduce(function(t,e){return e<t?e:t},1/0),e.reduce(function(t,e){return t<e?e:t},0),n.reduce(function(t,e){return t<e?e:t},0))}function U(t,e,n,r){void 0===r&&(r=!0);for(var o=e.map(function(t,e){return{score:t,boxIndex:e}}).sort(function(t,e){return t.score-e.score}).map(function(t){return t.boxIndex}),i=[];o.length>0;)!function(){var e=o.pop();i.push(e);for(var a=o,s=[],c=0;c<a.length;c++){var u=a[c],f=t[e],l=t[u];s.push(W(f,l,r))}o=o.filter(function(t,e){return s[e]<=n})}();return i}function V(t,e){return h.tidy(function(){var n=e[0],r=e[1],o=e[2],i=h.fill(b(t.shape.slice(0,3),[1]),n),a=h.fill(b(t.shape.slice(0,3),[1]),r),s=h.fill(b(t.shape.slice(0,3),[1]),o),c=h.concat([i,a,s],3);return h.sub(t,c)})}function G(t,e){return void 0===e&&(e=!1),h.tidy(function(){var n=t.shape.slice(1),r=n[0],o=n[1];if(r===o)return t;var i=Math.abs(r-o),a=r>o?2:1,s=function(e){var n=t.shape.slice();return n[a]=e,h.fill(n,0)},c=s(Math.round(i*(e?.5:1))),u=i-c.shape[a],f=[e&&u?s(u):null,t,c].filter(function(t){return!!t}).map(function(t){return t.toFloat()});return h.concat(f,a)})}function H(t){for(var e=t.slice(),n=e.length-1;n>0;n--){var r=Math.floor(Math.random()*(n+1)),o=e[n];e[n]=e[r],e[r]=o}return e}function Y(t){return 1/(1+Math.exp(-t))}function J(t){return Math.log(t/(1-t))}var Z=function(t){function e(e,n,r,o,i){return void 0===i&&(i=!1),t.call(this,{x:e,y:n,width:r,height:o},i)||this}return v(e,t),e}(I),q=function(){function t(t,e,n){void 0===n&&(n=new B(0,0));var r=e.width,o=e.height;this._imgDims=new w(r,o),this._shift=n,this._positions=t.map(function(t){return t.mul(new B(r,o)).add(n)})}return Object.defineProperty(t.prototype,"shift",{get:function(){return new B(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(e){return e.sub(t._shift).div(new B(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),t.prototype.forSize=function(t,e){return new this.constructor(this.relativePositions,{width:t,height:e})},t.prototype.shiftBy=function(t,e){return new this.constructor(this.relativePositions,this._imgDims,new B(t,e))},t.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},t.prototype.align=function(t,e){if(void 0===e&&(e={}),t){var n=t instanceof N?t.box.floor():new I(t);return this.shiftBy(n.x,n.y).align(null,e)}var r=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},e),o=r.useDlibAlignment,i=r.minBoxPadding;return o?this.alignDlib():this.alignMinBbox(i)},t.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),e=t[0],n=t[1],r=t[2],o=function(t){return r.sub(t).magnitude()},i=Math.floor((o(e)+o(n))/2/.45),a=A(t),s=Math.floor(Math.max(0,a.x-.5*i)),c=Math.floor(Math.max(0,a.y-.43*i));return new Z(s,c,Math.min(i,this.imageWidth+s),Math.min(i,this.imageHeight+c))},t.prototype.alignMinBbox=function(t){var e=z(this.positions);return e.pad(e.width*t,e.height*t)},t.prototype.getRefPointsForAlignment=function(){throw Error("getRefPointsForAlignment not implemented by base class")},t}(),X=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e.prototype.getRefPointsForAlignment=function(){var t=this.positions;return[t[0],t[1],A([t[3],t[4]])]},e}(q),$=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e.prototype.getJawOutline=function(){return this.positions.slice(0,17)},e.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},e.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},e.prototype.getNose=function(){return this.positions.slice(27,36)},e.prototype.getLeftEye=function(){return this.positions.slice(36,42)},e.prototype.getRightEye=function(){return this.positions.slice(42,48)},e.prototype.getMouth=function(){return this.positions.slice(48,68)},e.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(A)},e}(q),K=function(){function t(t,e){this._label=t,this._distance=e}return Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){return void 0===t&&(t=!0),""+this.label+(t?" ("+S(this.distance)+")":"")},t}(),Q=function(t){function e(e,n){var r=t.call(this,e)||this;return r._label=n,r}return v(e,t),e.assertIsValidLabeledBox=function(t,e){if(I.assertIsValidBox(t,e),!O(t.label))throw Error(e+" - expected property label ("+t.label+") to be a number")},Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),e}(I),tt=function(){function t(t,e){if("string"!=typeof t)throw Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(e)||e.some(function(t){return!(t instanceof Float32Array)}))throw Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=e}return Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},t.fromJSON=function(e){var n=e.descriptors.map(function(t){return new Float32Array(t)});return new t(e.label,n)},t}(),te=function(t){function e(e,n,r,o){var i=t.call(this,e,n)||this;return i._score=r,i._classScore=o,i}return v(e,t),e.assertIsValidPredictedBox=function(t,e){if(Q.assertIsValidLabeledBox(t,e),!L(t.score)||!L(t.classScore))throw Error(e+" - expected properties score ("+t.score+") and ("+t.classScore+") to be a number between [0, 1]")},Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),e}(Q);function tn(t){return t.detection instanceof N}function tr(t,e){return Object.assign({},t,{detection:e})}function to(){var t=window.fetch||function(){throw Error("fetch - missing fetch implementation for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D:CanvasRenderingContext2D,Image:HTMLImageElement,ImageData:ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:t,readFile:function(){throw Error("readFile - filesystem not available for browser environment")}}}function ti(t){var e="";if(!t)try{t=n(Object(function(){var t=Error("Cannot find module 'fs'");throw t.code="MODULE_NOT_FOUND",t}()))}catch(t){e=t.toString()}return{readFile:t?function(e){return new Promise(function(n,r){t.readFile(e,function(t,e){return t?r(t):n(e)})})}:function(){throw Error("readFile - failed to require fs in nodejs environment with error: "+e)}}}function ta(){var t=n.g.Canvas||n.g.HTMLCanvasElement,Image=n.g.Image||n.g.HTMLImageElement,e=n.g.fetch||function(){throw Error("fetch - missing fetch implementation for nodejs environment")},r=ti();return m({Canvas:t||function(){},CanvasRenderingContext2D:n.g.CanvasRenderingContext2D||function(){},Image:Image||function(){},ImageData:n.g.ImageData||function(){},Video:n.g.HTMLVideoElement||function(){},createCanvasElement:function(){if(t)return new t;throw Error("createCanvasElement - missing Canvas implementation for nodejs environment")},createImageElement:function(){if(Image)return new Image;throw Error("createImageElement - missing Image implementation for nodejs environment")},fetch:e},r)}function ts(){return"object"==typeof window&&"undefined"!=typeof document&&"undefined"!=typeof HTMLImageElement&&"undefined"!=typeof HTMLCanvasElement&&"undefined"!=typeof HTMLVideoElement&&"undefined"!=typeof ImageData&&"undefined"!=typeof CanvasRenderingContext2D}var tc=n(3454);function tu(){return"object"==typeof n.g&&void 0!==tc&&!!tc.version}function tf(){ts()&&(a=to()),tu()&&(a=ta())}var tl={getEnv:function(){if(!a)throw Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return a},setEnv:function(t){a=t},initialize:tf,createBrowserEnv:to,createFileSystem:ti,createNodejsEnv:ta,monkeyPatch:function(t){if(a||tf(),!a)throw Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var e=t.Canvas,n=void 0===e?a.Canvas:e,r=t.Image,Image=void 0===r?a.Image:r;a.Canvas=n,a.Image=Image,a.createCanvasElement=t.createCanvasElement||function(){return new n},a.createImageElement=t.createImageElement||function(){return new Image},a.ImageData=t.ImageData||a.ImageData,a.Video=t.Video||a.Video,a.fetch=t.fetch||a.fetch,a.readFile=t.readFile||a.readFile},isBrowser:ts,isNodejs:tu};function th(t){return tl.isNodejs()||"string"!=typeof t?t:document.getElementById(t)}function tp(t){var e=tl.getEnv(),n=e.Canvas;if(t instanceof e.CanvasRenderingContext2D)return t;var r=th(t);if(!(r instanceof n))throw Error("resolveContext2d - expected canvas to be of instance of Canvas");var o=r.getContext("2d");if(!o)throw Error("resolveContext2d - canvas 2d context is null");return o}tf(),(r=s||(s={})).TOP_LEFT="TOP_LEFT",r.TOP_RIGHT="TOP_RIGHT",r.BOTTOM_LEFT="BOTTOM_LEFT",r.BOTTOM_RIGHT="BOTTOM_RIGHT";var td=function(t){void 0===t&&(t={});var e=t.anchorPosition,n=t.backgroundColor,r=t.fontColor,o=t.fontSize,i=t.fontStyle,a=t.padding;this.anchorPosition=e||s.TOP_LEFT,this.backgroundColor=n||"rgba(0, 0, 0, 0.5)",this.fontColor=r||"rgba(255, 255, 255, 1)",this.fontSize=o||14,this.fontStyle=i||"Georgia",this.padding=a||4},tv=function(){function t(e,n,r){void 0===r&&(r={}),this.text="string"==typeof e?[e]:e instanceof t?e.text:e,this.anchor=n,this.options=new td(r)}return t.prototype.measureWidth=function(t){var e=this.options.padding;return this.text.map(function(e){return t.measureText(e).width}).reduce(function(t,e){return t<e?e:t},0)+2*e},t.prototype.measureHeight=function(){var t=this.options,e=t.fontSize,n=t.padding;return this.text.length*e+2*n},t.prototype.getUpperLeft=function(t,e){var n=this.options.anchorPosition,r=n===s.BOTTOM_RIGHT||n===s.TOP_RIGHT,o=n===s.BOTTOM_LEFT||n===s.BOTTOM_RIGHT,i=this.measureWidth(t),a=this.measureHeight(),c=r?this.anchor.x-i:this.anchor.x,u=o?this.anchor.y-a:this.anchor.y;return e?{x:Math.max(Math.min(c,e.width-i),0),y:Math.max(Math.min(u,e.height-a),0)}:{x:c,y:u}},t.prototype.draw=function(t){var e=th(t),n=tp(e),r=this.options,o=r.backgroundColor,i=r.fontColor,a=r.fontSize,s=r.fontStyle,c=r.padding;n.font=a+"px "+s;var u=this.measureWidth(n),f=this.measureHeight();n.fillStyle=o;var l=this.getUpperLeft(n,e);n.fillRect(l.x,l.y,u,f),n.fillStyle=i,this.text.forEach(function(t,e){var r=c+l.x,o=c+l.y+(e+1)*a;n.fillText(t,r,o)})},t}(),tm=function(t){void 0===t&&(t={});var e=t.boxColor,n=t.lineWidth,r=t.label,o=t.drawLabelOptions;this.boxColor=e||"rgba(0, 0, 255, 1)",this.lineWidth=n||2,this.label=r;var i={anchorPosition:s.BOTTOM_LEFT,backgroundColor:this.boxColor};this.drawLabelOptions=new td(Object.assign({},i,o))},tg=function(){function t(t,e){void 0===e&&(e={}),this.box=new I(t),this.options=new tm(e)}return t.prototype.draw=function(t){var e=tp(t),n=this.options,r=n.boxColor,o=n.lineWidth,i=this.box,a=i.x,s=i.y,c=i.width,u=i.height;e.strokeStyle=r,e.lineWidth=o,e.strokeRect(a,s,c,u);var f=this.options.label;f&&new tv([f],{x:a-o/2,y:s},this.options.drawLabelOptions).draw(t)},t}();function ty(t,e){(Array.isArray(e)?e:[e]).forEach(function(e){var n=e instanceof N?e.score:tn(e)?e.detection.score:void 0;new tg(e instanceof N?e.box:tn(e)?e.detection.box:new I(e),{label:n?""+S(n):void 0}).draw(t)})}function tb(t){var e=tl.getEnv(),Image=e.Image,n=e.Video;return t instanceof Image&&t.complete||t instanceof n&&t.readyState>=3}function tw(t){return new Promise(function(e,n){if(t instanceof tl.getEnv().Canvas||tb(t))return e();function r(t){t.currentTarget&&(t.currentTarget.removeEventListener("load",r),t.currentTarget.removeEventListener("error",o),e(t))}function o(t){t.currentTarget&&(t.currentTarget.removeEventListener("load",r),t.currentTarget.removeEventListener("error",o),n(t))}t.addEventListener("load",r),t.addEventListener("error",o)})}function t_(t){return new Promise(function(e,n){if(!(t instanceof Blob))return n("bufferToImage - expected buf to be of type: Blob");var r=new FileReader;r.onload=function(){if("string"!=typeof r.result)return n("bufferToImage - expected reader.result to be a string, in onload");var t=tl.getEnv().createImageElement();t.onload=function(){return e(t)},t.onerror=n,t.src=r.result},r.onerror=n,r.readAsDataURL(t)})}function tx(t){var e=tl.getEnv(),Image=e.Image,n=e.Video;return t instanceof Image?new w(t.naturalWidth,t.naturalHeight):t instanceof n?new w(t.videoWidth,t.videoHeight):new w(t.width,t.height)}function tE(t){var e=t.width,n=t.height,r=(0,tl.getEnv().createCanvasElement)();return r.width=e,r.height=n,r}function tP(t,e){var ImageData=tl.getEnv().ImageData;if(!(t instanceof ImageData)&&!tb(t))throw Error("createCanvasFromMedia - media has not finished loading yet");var n=e||tx(t),r=n.width,o=n.height,i=tE({width:r,height:o});return t instanceof ImageData?tp(i).putImageData(t,0,0):tp(i).drawImage(t,0,0,r,o),i}function tM(t,e){return g(this,void 0,void 0,function(){var n,r,o,i,a,s;return y(this,function(c){switch(c.label){case 0:return n=e||tl.getEnv().createCanvasElement(),o=(r=t.shape.slice(M(t)?1:0))[0],i=r[1],a=r[2],s=h.tidy(function(){return t.as3D(o,i,a).toInt()}),[4,h.browser.toPixels(s,n)];case 1:return c.sent(),s.dispose(),[2,n]}})})}function tT(t){var e=tl.getEnv(),Image=e.Image,n=e.Canvas,r=e.Video;return t instanceof Image||t instanceof n||t instanceof r}function tF(t,e,n){void 0===n&&(n=!1);var r=tl.getEnv(),Image=r.Image,o=r.Canvas;if(!(t instanceof Image||t instanceof o))throw Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var i=tx(t),a=e/Math.max(i.height,i.width),s=a*i.width,c=a*i.height,u=tE({width:e,height:e}),f=t instanceof o?t:tP(t),l=Math.abs(s-c)/2,h=n&&s<c?l:0,p=n&&c<s?l:0;return tp(u).drawImage(f,h,p,s,c),u}var tS=function(){function t(t,e){var n=this;if(void 0===e&&(e=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=e,this._batchSize=t.length,t.forEach(function(t,e){if(P(t)){n._imageTensors[e]=t,n._inputDimensions[e]=t.shape;return}if(M(t)){var r=t.shape[0];if(1!==r)throw Error("NetInput - tf.Tensor4D with batchSize "+r+" passed, but not supported in input array");n._imageTensors[e]=t,n._inputDimensions[e]=t.shape.slice(1);return}var o=t instanceof tl.getEnv().Canvas?t:tP(t);n._canvases[e]=o,n._inputDimensions[e]=[o.height,o.width,3]})}return Object.defineProperty(t.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reshapedInputDimensions",{get:function(){var t=this;return D(this.batchSize,0,1).map(function(e,n){return t.getReshapedInputDimensions(n)})},enumerable:!0,configurable:!0}),t.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},t.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},t.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},t.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},t.prototype.getReshapedInputDimensions=function(t){if("number"!=typeof this.inputSize)throw Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");return C({width:this.getInputWidth(t),height:this.getInputHeight(t)},this.inputSize)},t.prototype.toBatchTensor=function(t,e){var n=this;return void 0===e&&(e=!0),this._inputSize=t,h.tidy(function(){var r=D(n.batchSize,0,1).map(function(r){var o=n.getInput(r);if(o instanceof h.Tensor){var i=M(o)?o:o.expandDims();return((i=G(i,e)).shape[1]!==t||i.shape[2]!==t)&&(i=h.image.resizeBilinear(i,[t,t])),i.as3D(t,t,3)}if(o instanceof tl.getEnv().Canvas)return h.browser.fromPixels(tF(o,t,e));throw Error("toBatchTensor - at batchIdx "+r+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+o)});return h.stack(r.map(function(t){return t.toFloat()})).as4D(n.batchSize,t,t,3)})},t}();function tk(t){return g(this,void 0,void 0,function(){var e,n,r;return y(this,function(o){switch(o.label){case 0:if(t instanceof tS)return[2,t];if(!(e=Array.isArray(t)?t:[t]).length)throw Error("toNetInput - empty array passed as input");return n=function(e){return Array.isArray(t)?" at input index "+e+":":""},(r=e.map(th)).forEach(function(t,r){if(!tT(t)&&!P(t)&&!M(t)){if("string"==typeof e[r])throw Error("toNetInput -"+n(r)+" string passed, but could not resolve HTMLElement for element id "+e[r]);throw Error("toNetInput -"+n(r)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id")}if(M(t)){var o=t.shape[0];if(1!==o)throw Error("toNetInput -"+n(r)+" tf.Tensor4D with batchSize "+o+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(t){return tT(t)&&tw(t)}))];case 1:return o.sent(),[2,new tS(r,Array.isArray(t))]}})})}function tC(t,e){return g(this,void 0,void 0,function(){var n,r,o,i,a,s;return y(this,function(c){switch(c.label){case 0:if(n=tl.getEnv().Canvas,r=t,t instanceof n)return[3,5];return[4,tk(t)];case 1:if((o=c.sent()).batchSize>1)throw Error("extractFaces - batchSize > 1 not supported");if(!((i=o.getInput(0))instanceof n))return[3,2];return a=i,[3,4];case 2:return[4,tM(i)];case 3:a=c.sent(),c.label=4;case 4:r=a,c.label=5;case 5:return s=tp(r),[2,e.map(function(t){return t instanceof N?t.forSize(r.width,r.height).box.floor():t}).map(function(t){return t.clipAtImageBorders(r.width,r.height)}).map(function(t){var e=t.x,n=t.y,r=t.width,o=t.height,i=tE({width:r,height:o});return tp(i).putImageData(s.getImageData(e,n,r,o),0,0),i})]}})})}function tA(t,e){return g(this,void 0,void 0,function(){return y(this,function(n){if(!P(t)&&!M(t))throw Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(M(t)&&t.shape[0]>1)throw Error("extractFaceTensors - batchSize > 1 not supported");return[2,h.tidy(function(){var n=t.shape.slice(M(t)?1:0),r=n[0],o=n[1],i=n[2];return e.map(function(t){return t instanceof N?t.forSize(o,r).box:t}).map(function(t){return t.clipAtImageBorders(o,r)}).map(function(e){var n=e.x,a=e.y,s=e.width,c=e.height;return h.slice3d(t.as3D(r,o,i),[a,n,0],[c,s,i])})})]})})}function tD(t,e){return g(this,void 0,void 0,function(){var n;return y(this,function(r){switch(r.label){case 0:return[4,(0,tl.getEnv().fetch)(t,e)];case 1:if(!((n=r.sent()).status<400))throw Error("failed to fetch: ("+n.status+") "+n.statusText+", from url: "+n.url);return[2,n]}})})}function tO(t){return g(this,void 0,void 0,function(){var e,n;return y(this,function(r){switch(r.label){case 0:return[4,tD(t)];case 1:return[4,(e=r.sent()).blob()];case 2:if(!(n=r.sent()).type.startsWith("image/"))throw Error("fetchImage - expected blob type to be of type image/*, instead have: "+n.type+", for url: "+e.url);return[2,t_(n)]}})})}function tL(t){return g(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,tD(t)];case 1:return[2,e.sent().json()]}})})}function tB(t){return g(this,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:return e=Float32Array.bind,[4,tD(t)];case 1:return[4,n.sent().arrayBuffer()];case 2:return[2,new(e.apply(Float32Array,[void 0,n.sent()]))]}})})}function tI(t,e){var n=e+"-weights_manifest.json";if(!t)return{modelBaseUri:"",manifestUri:n};if("/"===t)return{modelBaseUri:"/",manifestUri:"/"+n};var r=t.startsWith("http://")?"http://":t.startsWith("https://")?"https://":"",o=(t=t.replace(r,"")).split("/").filter(function(t){return t}),i=t.endsWith(".json")?o[o.length-1]:n,a=r+(t.endsWith(".json")?o.slice(0,o.length-1):o).join("/");return{modelBaseUri:a=t.startsWith("/")?"/"+a:a,manifestUri:"/"===a?"/"+i:a+"/"+i}}function tj(t,e){return g(this,void 0,void 0,function(){var n,r,o,i;return y(this,function(a){switch(a.label){case 0:return r=(n=tI(t,e)).manifestUri,o=n.modelBaseUri,[4,tL(r)];case 1:return i=a.sent(),[2,h.io.loadWeights(i,o)]}})})}function tR(t,e,n){void 0===n&&(n=!1);var r=n?tx(e):e,o=r.width,i=r.height;return t.width=o,t.height=i,{width:o,height:i}}var tN=function(){function t(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(t.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),t.prototype.getParamFromPath=function(t){var e=this.traversePropertyPath(t);return e.obj[e.objProp]},t.prototype.reassignParamFromPath=function(t,e){var n=this.traversePropertyPath(t),r=n.obj,o=n.objProp;r[o].dispose(),r[o]=e},t.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(e){var n=e.paramPath;return{path:n,tensor:t.getParamFromPath(n)}})},t.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof h.Variable})},t.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof h.Variable)})},t.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(e){var n=e.path,r=e.tensor;t.reassignParamFromPath(n,r.variable())})},t.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(e){var n=e.path,r=e.tensor,o=h.tensor(r.dataSync());r.dispose(),t.reassignParamFromPath(n,o)})},t.prototype.dispose=function(t){void 0===t&&(t=!0),this.getParamList().forEach(function(e){if(t&&e.tensor.isDisposed)throw Error("param tensor has already been disposed for path "+e.path);e.tensor.dispose()}),this._params=void 0},t.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){return Array.from(t.tensor.dataSync())}).reduce(function(t,e){return t.concat(e)}))},t.prototype.load=function(t){return g(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:if(t instanceof Float32Array)return this.extractWeights(t),[2];return[4,this.loadFromUri(t)];case 1:return e.sent(),[2]}})})},t.prototype.loadFromUri=function(t){return g(this,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:if(t&&"string"!=typeof t)throw Error(this._name+".loadFromUri - expected model uri");return[4,tj(t,this.getDefaultModelName())];case 1:return e=n.sent(),this.loadFromWeightMap(e),[2]}})})},t.prototype.loadFromDisk=function(t){return g(this,void 0,void 0,function(){var e,n,r,o,i,a,s,c,u,f;return y(this,function(l){switch(l.label){case 0:if(t&&"string"!=typeof t)throw Error(this._name+".loadFromDisk - expected model file path");return e=tl.getEnv().readFile,r=(n=tI(t,this.getDefaultModelName())).manifestUri,o=n.modelBaseUri,i=function(t){return Promise.all(t.map(function(t){return e(t).then(function(t){return t.buffer})}))},a=h.io.weightsLoaderFactory(i),u=(c=JSON).parse,[4,e(r)];case 1:return s=u.apply(c,[l.sent().toString()]),[4,a(s,o)];case 2:return f=l.sent(),this.loadFromWeightMap(f),[2]}})})},t.prototype.loadFromWeightMap=function(t){var e=this.extractParamsFromWeigthMap(t),n=e.paramMappings,r=e.params;this._paramMappings=n,this._params=r},t.prototype.extractWeights=function(t){var e=this.extractParams(t),n=e.paramMappings,r=e.params;this._paramMappings=n,this._params=r},t.prototype.traversePropertyPath=function(t){if(!this.params)throw Error("traversePropertyPath - model has no loaded params");var e=t.split("/").reduce(function(e,n){if(!e.nextObj.hasOwnProperty(n))throw Error("traversePropertyPath - object does not have property "+n+", for path "+t);return{obj:e.nextObj,objProp:n,nextObj:e.nextObj[n]}},{nextObj:this.params}),n=e.obj,r=e.objProp;if(!n||!r||!(n[r]instanceof h.Tensor))throw Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:n,objProp:r}},t}();function tW(t,e,n){return h.tidy(function(){var r=h.separableConv2d(t,e.depthwise_filter,e.pointwise_filter,n,"same");return h.add(r,e.bias)})}function tz(t,e,n){return void 0===n&&(n=!1),h.tidy(function(){var r=h.relu(n?h.add(h.conv2d(t,e.conv0.filters,[2,2],"same"),e.conv0.bias):tW(t,e.conv0,[2,2])),o=tW(r,e.conv1,[1,1]),i=tW(h.relu(h.add(r,o)),e.conv2,[1,1]);return h.relu(h.add(r,h.add(o,i)))})}function tU(t,e,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),h.tidy(function(){var o=h.relu(n?h.add(h.conv2d(t,e.conv0.filters,r?[2,2]:[1,1],"same"),e.conv0.bias):tW(t,e.conv0,r?[2,2]:[1,1])),i=tW(o,e.conv1,[1,1]),a=tW(h.relu(h.add(o,i)),e.conv2,[1,1]),s=tW(h.relu(h.add(o,h.add(i,a))),e.conv3,[1,1]);return h.relu(h.add(o,h.add(i,h.add(a,s))))})}function tV(t,e,n,r){return void 0===n&&(n="same"),void 0===r&&(r=!1),h.tidy(function(){var o=h.add(h.conv2d(t,e.filters,[1,1],n),e.bias);return r?h.relu(o):o})}function tG(t,e){Object.keys(t).forEach(function(n){e.some(function(t){return t.originalPath===n})||t[n].dispose()})}function tH(t,e){return function(n,r,o,i){var a=h.tensor4d(t(n*r*o*o),[o,o,n,r]),s=h.tensor1d(t(r));return e.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:a,bias:s}}}function tY(t,e){return function(n,r,o){var i=h.tensor2d(t(n*r),[n,r]),a=h.tensor1d(t(r));return e.push({paramPath:o+"/weights"},{paramPath:o+"/bias"}),{weights:i,bias:a}}}var tJ=function(t,e,n){this.depthwise_filter=t,this.pointwise_filter=e,this.bias=n};function tZ(t,e){return function(n,r,o){var i=h.tensor4d(t(9*n),[3,3,n,1]),a=h.tensor4d(t(n*r),[1,1,n,r]),s=h.tensor1d(t(r));return e.push({paramPath:o+"/depthwise_filter"},{paramPath:o+"/pointwise_filter"},{paramPath:o+"/bias"}),new tJ(i,a,s)}}function tq(t){return function(e){return new tJ(t(e+"/depthwise_filter",4),t(e+"/pointwise_filter",4),t(e+"/bias",1))}}function tX(t,e){return function(n,r,o){var i=t[n];if(!_(i,r))throw Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+i);return e.push({originalPath:n,paramPath:o||n}),i}}function t$(t){var e=t;return{extractWeights:function(t){var n=e.slice(0,t);return e=e.slice(t),n},getRemainingWeights:function(){return e}}}function tK(t,e){var n=tH(t,e),r=tZ(t,e);function o(t,e,o,i){return void 0===i&&(i=!1),{conv0:i?n(t,e,3,o+"/conv0"):r(t,e,o+"/conv0"),conv1:r(e,e,o+"/conv1"),conv2:r(e,e,o+"/conv2")}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:function(t,e,n,i){void 0===i&&(i=!1);var a=o(t,e,n,i);return{conv0:a.conv0,conv1:a.conv1,conv2:a.conv2,conv3:r(e,e,n+"/conv3")}}}}function tQ(t){return function(e){return{filters:t(e+"/filters",4),bias:t(e+"/bias",1)}}}function t0(t,e){var n=tX(t,e),r=tQ(n),o=tq(n);return{extractDenseBlock3Params:function(t,e){return void 0===e&&(e=!1),{conv0:e?r(t+"/conv0"):o(t+"/conv0"),conv1:o(t+"/conv1"),conv2:o(t+"/conv2")}},extractDenseBlock4Params:function(t,e){return void 0===e&&(e=!1),{conv0:e?r(t+"/conv0"):o(t+"/conv0"),conv1:o(t+"/conv1"),conv2:o(t+"/conv2"),conv3:o(t+"/conv3")}}}}var t1=function(t){function e(){return t.call(this,"FaceFeatureExtractor")||this}return v(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw Error("FaceFeatureExtractor - load model before inference");return h.tidy(function(){var n=tU(V(t.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(h.scalar(255)),e.dense0,!0);return n=tU(n,e.dense1),n=tU(n,e.dense2),n=tU(n,e.dense3),n=h.avgPool(n,[7,7],[2,2],"valid")})},e.prototype.forward=function(t){return g(this,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:return e=this.forwardInput,[4,tk(t)];case 1:return[2,e.apply(this,[n.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},e.prototype.extractParamsFromWeigthMap=function(t){var e,n,r;return r={dense0:(n=t0(t,e=[]).extractDenseBlock4Params)("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")},tG(t,e),{params:r,paramMappings:e}},e.prototype.extractParams=function(t){return function(t){var e=[],n=t$(t),r=n.extractWeights,o=n.getRemainingWeights,i=tK(r,e).extractDenseBlock4Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),c=i(64,128,"dense2"),u=i(128,256,"dense3");if(0!==o().length)throw Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{dense0:a,dense1:s,dense2:c,dense3:u}}}(t)},e}(tN);function t2(t,e){return h.tidy(function(){return h.add(h.matMul(t,e.weights),e.bias)})}function t5(t){var e={},n={};return Object.keys(t).forEach(function(r){(r.startsWith("fc")?n:e)[r]=t[r]}),{featureExtractorMap:e,classifierMap:n}}var t4=function(t){function e(e,n){var r=t.call(this,e)||this;return r._faceFeatureExtractor=n,r}return v(e,t),Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(t){var e=this,n=this.params;if(!n)throw Error(this._name+" - load model before inference");return h.tidy(function(){var r=t instanceof tS?e.faceFeatureExtractor.forwardInput(t):t;return t2(r.as2D(r.shape[0],-1),n.fc)})},e.prototype.dispose=function(e){void 0===e&&(e=!0),this.faceFeatureExtractor.dispose(e),t.prototype.dispose.call(this,e)},e.prototype.loadClassifierParams=function(t){var e=this.extractClassifierParams(t),n=e.params,r=e.paramMappings;this._params=n,this._paramMappings=r},e.prototype.extractClassifierParams=function(t){return function(t,e,n){var r=[],o=t$(t),i=o.extractWeights,a=o.getRemainingWeights,s=tY(i,r)(e,n,"fc");if(0!==a().length)throw Error("weights remaing after extract: "+a().length);return{paramMappings:r,params:{fc:s}}}(t,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},e.prototype.extractParamsFromWeigthMap=function(t){var e,n,r,o=t5(t),i=o.featureExtractorMap,a=o.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(i),r={fc:{weights:(n=tX(a,e=[]))("fc/weights",2),bias:n("fc/bias",1)}},tG(a,e),{params:r,paramMappings:e}},e.prototype.extractParams=function(t){var e=this.getClassifierChannelsIn(),n=this.getClassifierChannelsOut(),r=n*e+n,o=t.slice(0,t.length-r),i=t.slice(t.length-r);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(i)},e}(tN),t3=["neutral","happy","sad","angry","fearful","disgusted","surprised"],t6=function(){function t(t){var e=this;if(7!==t.length)throw Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);t3.forEach(function(n,r){e[n]=t[r]})}return t.prototype.asSortedArray=function(){var t=this;return t3.map(function(e){return{expression:e,probability:t[e]}}).sort(function(t,e){return e.probability-t.probability})},t}(),t8=function(t){function e(e){return void 0===e&&(e=new t1),t.call(this,"FaceExpressionNet",e)||this}return v(e,t),e.prototype.forwardInput=function(t){var e=this;return h.tidy(function(){return h.softmax(e.runNet(t))})},e.prototype.forward=function(t){return g(this,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:return e=this.forwardInput,[4,tk(t)];case 1:return[2,e.apply(this,[n.sent()])]}})})},e.prototype.predictExpressions=function(t){return g(this,void 0,void 0,function(){var e,n,r,o,i=this;return y(this,function(a){switch(a.label){case 0:return[4,tk(t)];case 1:return e=a.sent(),[4,this.forwardInput(e)];case 2:return n=a.sent(),[4,Promise.all(h.unstack(n).map(function(t){return g(i,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:return[4,t.data()];case 1:return e=n.sent(),t.dispose(),[2,e]}})})}))];case 3:return r=a.sent(),n.dispose(),o=r.map(function(t){return new t6(t)}),[2,e.isBatchInput?o:o[0]]}})})},e.prototype.getDefaultModelName=function(){return"face_expression_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e.prototype.getClassifierChannelsOut=function(){return 7},e}(t4);function t7(t){return t.expressions instanceof t6}function t9(t,e){return Object.assign({},t,{expressions:e})}function et(t,e,n,r){void 0===n&&(n=.1),(Array.isArray(e)?e:[e]).forEach(function(e){var o=e instanceof t6?e:t7(e)?e.expressions:void 0;if(!o)throw Error("drawFaceExpressions - expected faceExpressions to be FaceExpressions | WithFaceExpressions<{}> or array thereof");var i=o.asSortedArray().filter(function(t){return t.probability>n}),a=tn(e)?e.detection.box.bottomLeft:r||new B(0,0);new tv(i.map(function(t){return t.expression+" ("+S(t.probability)+")"}),a).draw(t)})}function ee(t){return tn(t)&&t.landmarks instanceof q&&t.unshiftedLandmarks instanceof q&&t.alignedRect instanceof N}function en(t,e){var n=t.detection.box,r=e.shiftBy(n.x,n.y),o=r.align(),i=t.detection.imageDims,a=new N(t.detection.score,o.rescale(i.reverse()),i);return Object.assign({},t,{landmarks:r,unshiftedLandmarks:e,alignedRect:a})}var er=function(t){void 0===t&&(t={});var e=t.drawLines,n=t.drawPoints,r=t.lineWidth,o=t.lineColor,i=t.pointSize,a=t.pointColor;this.drawLines=void 0===e||e,this.drawPoints=void 0===n||n,this.lineWidth=r||1,this.pointSize=i||2,this.lineColor=o||"rgba(0, 255, 255, 1)",this.pointColor=a||"rgba(255, 0, 255, 1)"},eo=function(){function t(t,e){void 0===e&&(e={}),this.faceLandmarks=t,this.options=new er(e)}return t.prototype.draw=function(t){var e=tp(t),n=this.options,r=n.drawLines,o=n.drawPoints,i=n.lineWidth,a=n.lineColor,s=n.pointSize,c=n.pointColor;r&&this.faceLandmarks instanceof $&&(e.strokeStyle=a,e.lineWidth=i,p(e,this.faceLandmarks.getJawOutline()),p(e,this.faceLandmarks.getLeftEyeBrow()),p(e,this.faceLandmarks.getRightEyeBrow()),p(e,this.faceLandmarks.getNose()),p(e,this.faceLandmarks.getLeftEye(),!0),p(e,this.faceLandmarks.getRightEye(),!0),p(e,this.faceLandmarks.getMouth(),!0)),o&&(e.strokeStyle=c,e.fillStyle=c,this.faceLandmarks.positions.forEach(function(t){e.beginPath(),e.arc(t.x,t.y,s,0,2*Math.PI),e.fill()}))},t}();function ei(t,e){(Array.isArray(e)?e:[e]).forEach(function(e){var n=e instanceof q?e:ee(e)?e.landmarks:void 0;if(!n)throw Error("drawFaceLandmarks - expected faceExpressions to be FaceLandmarks | WithFaceLandmarks<WithFaceDetection<{}>> or array thereof");new eo(n).draw(t)})}function ea(t,e,n){return h.add(h.conv2d(t,e.filters,n,"same"),e.bias)}function es(t,e,n){void 0===n&&(n=!0);var r=n?h.relu(t):t;return r=tW(r,e.separable_conv0,[1,1]),r=tW(h.relu(r),e.separable_conv1,[1,1]),r=h.maxPool(r,[3,3],[2,2],"same"),r=h.add(r,ea(t,e.expansion_conv,[2,2]))}var ec=function(t){function e(e){var n=t.call(this,"TinyXception")||this;return n._numMainBlocks=e,n}return v(e,t),e.prototype.forwardInput=function(t){var e=this,n=this.params;if(!n)throw Error("TinyXception - load model before inference");return h.tidy(function(){var r=V(t.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(h.scalar(256)),o=h.relu(ea(r,n.entry_flow.conv_in,[2,2]));return o=es(o,n.entry_flow.reduction_block_0,!1),o=es(o,n.entry_flow.reduction_block_1),D(e._numMainBlocks,0,1).forEach(function(t){var e,r,i;e=o,r=n.middle_flow["main_block_"+t],i=tW(h.relu(e),r.separable_conv0,[1,1]),i=tW(h.relu(i),r.separable_conv1,[1,1]),i=tW(h.relu(i),r.separable_conv2,[1,1]),o=i=h.add(i,e)}),o=es(o,n.exit_flow.reduction_block),o=h.relu(tW(o,n.exit_flow.separable_conv,[1,1]))})},e.prototype.forward=function(t){return g(this,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:return e=this.forwardInput,[4,tk(t)];case 1:return[2,e.apply(this,[n.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"tiny_xception_model"},e.prototype.extractParamsFromWeigthMap=function(t){return function(t,e){var n,r,o,i=[],a={extractConvParams:r=tQ(n=tX(t,i)),extractSeparableConvParams:o=tq(n),extractReductionBlockParams:function(t){return{separable_conv0:o(t+"/separable_conv0"),separable_conv1:o(t+"/separable_conv1"),expansion_conv:r(t+"/expansion_conv")}},extractMainBlockParams:function(t){return{separable_conv0:o(t+"/separable_conv0"),separable_conv1:o(t+"/separable_conv1"),separable_conv2:o(t+"/separable_conv2")}}},s=a.extractConvParams,c=a.extractSeparableConvParams,u=a.extractReductionBlockParams,f=a.extractMainBlockParams,l=s("entry_flow/conv_in"),h=u("entry_flow/reduction_block_0"),p=u("entry_flow/reduction_block_1"),d={};D(e,0,1).forEach(function(t){d["main_block_"+t]=f("middle_flow/main_block_"+t)});var v=u("exit_flow/reduction_block"),m=c("exit_flow/separable_conv");return tG(t,i),{params:{entry_flow:{conv_in:l,reduction_block_0:h,reduction_block_1:p},middle_flow:d,exit_flow:{reduction_block:v,separable_conv:m}},paramMappings:i}}(t,this._numMainBlocks)},e.prototype.extractParams=function(t){return function(t,e){var n,r,o=[],i=t$(t),a=i.extractWeights,s=i.getRemainingWeights,c={extractConvParams:n=tH(a,o),extractSeparableConvParams:r=tZ(a,o),extractReductionBlockParams:function(t,e,o){return{separable_conv0:r(t,e,o+"/separable_conv0"),separable_conv1:r(e,e,o+"/separable_conv1"),expansion_conv:n(t,e,1,o+"/expansion_conv")}},extractMainBlockParams:function(t,e){return{separable_conv0:r(t,t,e+"/separable_conv0"),separable_conv1:r(t,t,e+"/separable_conv1"),separable_conv2:r(t,t,e+"/separable_conv2")}}},u=c.extractConvParams,f=c.extractSeparableConvParams,l=c.extractReductionBlockParams,h=c.extractMainBlockParams,p=u(3,32,3,"entry_flow/conv_in"),d=l(32,64,"entry_flow/reduction_block_0"),v=l(64,128,"entry_flow/reduction_block_1"),m={};D(e,0,1).forEach(function(t){m["main_block_"+t]=h(128,"middle_flow/main_block_"+t)});var g=l(128,256,"exit_flow/reduction_block"),y=f(256,512,"exit_flow/separable_conv");if(0!==s().length)throw Error("weights remaing after extract: "+s().length);return{paramMappings:o,params:{entry_flow:{conv_in:p,reduction_block_0:d,reduction_block_1:v},middle_flow:m,exit_flow:{reduction_block:g,separable_conv:y}}}}(t,this._numMainBlocks)},e}(tN);(o=c||(c={})).FEMALE="female",o.MALE="male";var eu=function(t){function e(e){void 0===e&&(e=new ec(2));var n=t.call(this,"AgeGenderNet")||this;return n._faceFeatureExtractor=e,n}return v(e,t),Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(t){var e=this,n=this.params;if(!n)throw Error(this._name+" - load model before inference");return h.tidy(function(){var r=t instanceof tS?e.faceFeatureExtractor.forwardInput(t):t,o=h.avgPool(r,[7,7],[2,2],"valid").as2D(r.shape[0],-1);return{age:t2(o,n.fc.age).as1D(),gender:t2(o,n.fc.gender)}})},e.prototype.forwardInput=function(t){var e=this;return h.tidy(function(){var n=e.runNet(t),r=n.age,o=n.gender;return{age:r,gender:h.softmax(o)}})},e.prototype.forward=function(t){return g(this,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:return e=this.forwardInput,[4,tk(t)];case 1:return[2,e.apply(this,[n.sent()])]}})})},e.prototype.predictAgeAndGender=function(t){return g(this,void 0,void 0,function(){var e,n,r,o,i,a=this;return y(this,function(s){switch(s.label){case 0:return[4,tk(t)];case 1:return e=s.sent(),[4,this.forwardInput(e)];case 2:return n=s.sent(),r=h.unstack(n.age),o=h.unstack(n.gender),[4,Promise.all(r.map(function(t,e){return{ageTensor:t,genderTensor:o[e]}}).map(function(t){var e=t.ageTensor,n=t.genderTensor;return g(a,void 0,void 0,function(){var t,r,o,i,a;return y(this,function(s){switch(s.label){case 0:return[4,e.data()];case 1:return t=s.sent()[0],[4,n.data()];case 2:return i=(o=(r=s.sent()[0])>.5)?c.MALE:c.FEMALE,a=o?r:1-r,e.dispose(),n.dispose(),[2,{age:t,gender:i,genderProbability:a}]}})})}))];case 3:return i=s.sent(),n.age.dispose(),n.gender.dispose(),[2,e.isBatchInput?i:i[0]]}})})},e.prototype.getDefaultModelName=function(){return"age_gender_model"},e.prototype.dispose=function(e){void 0===e&&(e=!0),this.faceFeatureExtractor.dispose(e),t.prototype.dispose.call(this,e)},e.prototype.loadClassifierParams=function(t){var e=this.extractClassifierParams(t),n=e.params,r=e.paramMappings;this._params=n,this._paramMappings=r},e.prototype.extractClassifierParams=function(t){return function(t){var e=[],n=t$(t),r=n.extractWeights,o=n.getRemainingWeights,i=tY(r,e),a=i(512,1,"fc/age"),s=i(512,2,"fc/gender");if(0!==o().length)throw Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{fc:{age:a,gender:s}}}}(t)},e.prototype.extractParamsFromWeigthMap=function(t){var e=t5(t),n=e.featureExtractorMap,r=e.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(n),function(t){var e=[],n=tX(t,e);function r(t){return{weights:n(t+"/weights",2),bias:n(t+"/bias",1)}}var o={fc:{age:r("fc/age"),gender:r("fc/gender")}};return tG(t,e),{params:o,paramMappings:e}}(r)},e.prototype.extractParams=function(t){var e=t.slice(0,t.length-1539),n=t.slice(t.length-1539);return this.faceFeatureExtractor.extractWeights(e),this.extractClassifierParams(n)},e}(tN),ef=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e.prototype.postProcess=function(t,e,n){var r=n.map(function(t){var n=t.width,r=t.height,o=e/Math.max(r,n);return{width:n*o,height:r*o}}),o=r.length;return h.tidy(function(){var n=function(t,e){return h.stack([h.fill([68],t),h.fill([68],e)],1).as2D(1,136).as1D()},i=function(t,e){var n=r[t],o=n.width,i=n.height;return e(o,i)?Math.abs(o-i)/2:0};return t.mul(h.fill([o,136],e)).sub(h.stack(Array.from(Array(o),function(t,e){return n(i(e,function(t,e){return t<e}),i(e,function(t,e){return e<t}))}))).div(h.stack(Array.from(Array(o),function(t,e){return n(r[e].width,r[e].height)})))})},e.prototype.forwardInput=function(t){var e=this;return h.tidy(function(){var n=e.runNet(t);return e.postProcess(n,t.inputSize,t.inputDimensions.map(function(t){return{height:t[0],width:t[1]}}))})},e.prototype.forward=function(t){return g(this,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:return e=this.forwardInput,[4,tk(t)];case 1:return[2,e.apply(this,[n.sent()])]}})})},e.prototype.detectLandmarks=function(t){return g(this,void 0,void 0,function(){var e,n,r,o=this;return y(this,function(i){switch(i.label){case 0:return[4,tk(t)];case 1:return e=i.sent(),[4,Promise.all((n=h.tidy(function(){return h.unstack(o.forwardInput(e))})).map(function(t,n){return g(o,void 0,void 0,function(){var r,o,i,a,s;return y(this,function(c){switch(c.label){case 0:return i=(o=Array).from,[4,t.data()];case 1:return a=(r=i.apply(o,[c.sent()])).filter(function(t,e){return F(e)}),s=r.filter(function(t,e){return!F(e)}),[2,new $(Array(68).fill(0).map(function(t,e){return new B(a[e],s[e])}),{height:e.getInputHeight(n),width:e.getInputWidth(n)})]}})})}))];case 2:return r=i.sent(),n.forEach(function(t){return t.dispose()}),[2,e.isBatchInput?r:r[0]]}})})},e.prototype.getClassifierChannelsOut=function(){return 136},e}(t4),el=function(t){function e(e){return void 0===e&&(e=new t1),t.call(this,"FaceLandmark68Net",e)||this}return v(e,t),e.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e}(ef),eh=function(t){function e(){return t.call(this,"TinyFaceFeatureExtractor")||this}return v(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw Error("TinyFaceFeatureExtractor - load model before inference");return h.tidy(function(){var n=tz(V(t.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(h.scalar(255)),e.dense0,!0);return n=tz(n,e.dense1),n=tz(n,e.dense2),n=h.avgPool(n,[14,14],[2,2],"valid")})},e.prototype.forward=function(t){return g(this,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:return e=this.forwardInput,[4,tk(t)];case 1:return[2,e.apply(this,[n.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},e.prototype.extractParamsFromWeigthMap=function(t){var e,n,r;return r={dense0:(n=t0(t,e=[]).extractDenseBlock3Params)("dense0",!0),dense1:n("dense1"),dense2:n("dense2")},tG(t,e),{params:r,paramMappings:e}},e.prototype.extractParams=function(t){return function(t){var e=[],n=t$(t),r=n.extractWeights,o=n.getRemainingWeights,i=tK(r,e).extractDenseBlock3Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),c=i(64,128,"dense2");if(0!==o().length)throw Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{dense0:a,dense1:s,dense2:c}}}(t)},e}(tN),ep=function(t){function e(e){return void 0===e&&(e=new eh),t.call(this,"FaceLandmark68TinyNet",e)||this}return v(e,t),e.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},e.prototype.getClassifierChannelsIn=function(){return 128},e}(ef),ed=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e}(el);function ev(t,e,n,r,o){void 0===o&&(o="same");var i,a,s=e.conv,c=s.filters,u=s.bias,f=h.conv2d(t,c,n,o);return i=f=h.add(f,u),a=e.scale,f=h.add(h.mul(i,a.weights),a.biases),r?h.relu(f):f}function em(t,e){return ev(t,e,[1,1],!1)}function eg(t,e){return ev(t,e,[2,2],!0,"valid")}function ey(t,e){var n=ev(t,e.conv1,[1,1],!0);return n=em(n,e.conv2),n=h.add(n,t),n=h.relu(n)}function eb(t,e){var n=eg(t,e.conv1);n=em(n,e.conv2);var r=h.avgPool(t,2,2,"valid"),o=h.zeros(r.shape),i=r.shape[3]!==n.shape[3];if(r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2]){var a=b(n.shape);a[1]=1;var s=h.zeros(a),c=b((n=h.concat([n,s],1)).shape);c[2]=1;var u=h.zeros(c);n=h.concat([n,u],2)}return r=i?h.concat([r,o],3):r,n=h.add(r,n),n=h.relu(n)}var ew=function(t){function e(){return t.call(this,"FaceRecognitionNet")||this}return v(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw Error("FaceRecognitionNet - load model before inference");return h.tidy(function(){var n=eg(V(t.toBatchTensor(150,!0).toFloat(),[122.782,117.001,104.298]).div(h.scalar(256)),e.conv32_down);n=ey(n=h.maxPool(n,3,2,"valid"),e.conv32_1),n=ey(n,e.conv32_2),n=eb(n=ey(n,e.conv32_3),e.conv64_down),n=ey(n,e.conv64_1),n=ey(n,e.conv64_2),n=eb(n=ey(n,e.conv64_3),e.conv128_down),n=ey(n,e.conv128_1),n=eb(n=ey(n,e.conv128_2),e.conv256_down),n=ey(n,e.conv256_1);var r=(n=eb(n=ey(n,e.conv256_2),e.conv256_down_out)).mean([1,2]);return h.matMul(r,e.fc)})},e.prototype.forward=function(t){return g(this,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:return e=this.forwardInput,[4,tk(t)];case 1:return[2,e.apply(this,[n.sent()])]}})})},e.prototype.computeFaceDescriptor=function(t){return g(this,void 0,void 0,function(){var e,n,r,o=this;return y(this,function(i){switch(i.label){case 0:return[4,tk(t)];case 1:return e=i.sent(),[4,Promise.all((n=h.tidy(function(){return h.unstack(o.forwardInput(e))})).map(function(t){return t.data()}))];case 2:return r=i.sent(),n.forEach(function(t){return t.dispose()}),[2,e.isBatchInput?r:r[0]]}})})},e.prototype.getDefaultModelName=function(){return"face_recognition_model"},e.prototype.extractParamsFromWeigthMap=function(t){return function(t){var e=[],n=function(t,e){var n=tX(t,e);function r(t){return{conv:{filters:n(t+"/conv/filters",4),bias:n(t+"/conv/bias",1)},scale:{weights:n(t+"/scale/weights",1),biases:n(t+"/scale/biases",1)}}}return{extractConvLayerParams:r,extractResidualLayerParams:function(t){return{conv1:r(t+"/conv1"),conv2:r(t+"/conv2")}}}}(t,e),r=n.extractConvLayerParams,o=n.extractResidualLayerParams,i=r("conv32_down"),a=o("conv32_1"),s=o("conv32_2"),c=o("conv32_3"),u=o("conv64_down"),f=o("conv64_1"),l=o("conv64_2"),h=o("conv64_3"),p=o("conv128_down"),d=o("conv128_1"),v=o("conv128_2"),m=o("conv256_down"),g=o("conv256_1"),y=o("conv256_2"),b=o("conv256_down_out"),w=t.fc;if(e.push({originalPath:"fc",paramPath:"fc"}),!E(w))throw Error("expected weightMap[fc] to be a Tensor2D, instead have "+w);return tG(t,e),{params:{conv32_down:i,conv32_1:a,conv32_2:s,conv32_3:c,conv64_down:u,conv64_1:f,conv64_2:l,conv64_3:h,conv128_down:p,conv128_1:d,conv128_2:v,conv256_down:m,conv256_1:g,conv256_2:y,conv256_down_out:b,fc:w},paramMappings:e}}(t)},e.prototype.extractParams=function(t){return function(t){var e=t$(t),n=e.extractWeights,r=e.getRemainingWeights,o=[],i=function(t,e){function n(n,r,o,i){var a,s,c,u,f,l;return{conv:(a=i+"/conv",s=function(e,n,r){var o=t(e),i=o.length/(n*r*r);if(T(i))throw Error("depth has to be an integer: "+i+", weights.length: "+o.length+", numFilters: "+n+", filterSize: "+r);return h.tidy(function(){return h.transpose(h.tensor4d(o,[n,i,r,r]),[2,3,1,0])})}(n,r,o),c=h.tensor1d(t(r)),e.push({paramPath:a+"/filters"},{paramPath:a+"/bias"}),{filters:s,bias:c}),scale:(u=i+"/scale",f=h.tensor1d(t(r)),l=h.tensor1d(t(r)),e.push({paramPath:u+"/weights"},{paramPath:u+"/biases"}),{weights:f,biases:l})}}return{extractConvLayerParams:n,extractResidualLayerParams:function(t,e,r,o,i){return void 0===i&&(i=!1),{conv1:n((i?.5:1)*t,e,r,o+"/conv1"),conv2:n(t,e,r,o+"/conv2")}}}}(n,o),a=i.extractConvLayerParams,s=i.extractResidualLayerParams,c=a(4704,32,7,"conv32_down"),u=s(9216,32,3,"conv32_1"),f=s(9216,32,3,"conv32_2"),l=s(9216,32,3,"conv32_3"),p=s(36864,64,3,"conv64_down",!0),d=s(36864,64,3,"conv64_1"),v=s(36864,64,3,"conv64_2"),m=s(36864,64,3,"conv64_3"),g=s(147456,128,3,"conv128_down",!0),y=s(147456,128,3,"conv128_1"),b=s(147456,128,3,"conv128_2"),w=s(589824,256,3,"conv256_down",!0),_=s(589824,256,3,"conv256_1"),x=s(589824,256,3,"conv256_2"),E=s(589824,256,3,"conv256_down_out"),P=h.tidy(function(){return h.transpose(h.tensor2d(n(32768),[128,256]),[1,0])});if(o.push({paramPath:"fc"}),0!==r().length)throw Error("weights remaing after extract: "+r().length);return{params:{conv32_down:c,conv32_1:u,conv32_2:f,conv32_3:l,conv64_down:p,conv64_1:d,conv64_2:v,conv64_3:m,conv128_down:g,conv128_1:y,conv128_2:b,conv256_down:w,conv256_1:_,conv256_2:x,conv256_down_out:E,fc:P},paramMappings:o}}(t)},e}(tN);function e_(t){var e=new ew;return e.extractWeights(t),e}function ex(t,e){return Object.assign({},t,{descriptor:e})}function eE(t){return"number"==typeof t.age}function eP(t,e){return Object.assign({},t,{age:e})}function eM(t){return(t.gender===c.MALE||t.gender===c.FEMALE)&&L(t.genderProbability)}function eT(t,e,n){return Object.assign({},t,{gender:e,genderProbability:n})}var eF=function(){function t(t){var e=void 0===t?{}:t,n=e.minFaceSize,r=e.scaleFactor,o=e.maxNumScales,i=e.scoreThresholds,a=e.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=n||20,this._scaleFactor=r||.709,this._maxNumScales=o||10,this._scoreThresholds=i||[.6,.7,.7],this._scaleSteps=a,"number"!=typeof this._minFaceSize||this._minFaceSize<0)throw Error(this._name+" - expected minFaceSize to be a number > 0");if("number"!=typeof this._scaleFactor||this._scaleFactor<=0||this._scaleFactor>=1)throw Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if("number"!=typeof this._maxNumScales||this._maxNumScales<0)throw Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||3!==this._scoreThresholds.length||this._scoreThresholds.some(function(t){return"number"!=typeof t}))throw Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(t){return"number"!=typeof t})))throw Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(t.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),t}();function eS(t,e,n){return h.tidy(function(){var r=h.conv2d(t,e.filters,n,"same");return r=h.add(r,e.batch_norm_offset),h.clipByValue(r,0,6)})}function ek(t,e){return h.tidy(function(){var n=t.shape[0];return{boxPredictionEncoding:h.reshape(tV(t,e.box_encoding_predictor),[n,-1,1,4]),classPrediction:h.reshape(tV(t,e.class_predictor),[n,-1,3])}})}var eC=function(){function t(t){var e=void 0===t?{}:t,n=e.minConfidence,r=e.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=n||.5,this._maxResults=r||100,"number"!=typeof this._minConfidence||this._minConfidence<=0||this._minConfidence>=1)throw Error(this._name+" - expected minConfidence to be a number between 0 and 1");if("number"!=typeof this._maxResults)throw Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(t.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),t}(),eA=function(t){function e(){return t.call(this,"SsdMobilenetv1")||this}return v(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw Error("SsdMobilenetv1 - load model before inference");return h.tidy(function(){var n,r,o,i,a,s,c=t.toBatchTensor(512,!1).toFloat(),u=(n=h.sub(h.mul(c,h.scalar(.007843137718737125)),h.scalar(1)),r=e.mobilenetv1,h.tidy(function(){var t=null,e=eS(n,r.conv_0,[2,2]);if([r.conv_1,r.conv_2,r.conv_3,r.conv_4,r.conv_5,r.conv_6,r.conv_7,r.conv_8,r.conv_9,r.conv_10,r.conv_11,r.conv_12,r.conv_13].forEach(function(n,r){var o,i,a=r+1,s=[2,4,6,12].some(function(t){return t===a})?[2,2]:[1,1];o=e,i=n.depthwise_conv,e=eS(e=h.tidy(function(){var t=h.depthwiseConv2d(o,i.filters,s,"same");return t=h.batchNorm(t,i.batch_norm_mean,i.batch_norm_variance,i.batch_norm_offset,i.batch_norm_scale,.0010000000474974513),h.clipByValue(t,0,6)}),n.pointwise_conv,[1,1]),11===a&&(t=e)}),null===t)throw Error("mobileNetV1 - output of conv layer 11 is null");return{out:e,conv11:t}})),f=(o=u.out,i=u.conv11,a=e.prediction_layer,h.tidy(function(){var t=eS(o,a.conv_0,[1,1]),e=eS(t,a.conv_1,[2,2]),n=eS(e,a.conv_2,[1,1]),r=eS(n,a.conv_3,[2,2]),s=eS(r,a.conv_4,[1,1]),c=eS(s,a.conv_5,[2,2]),u=eS(c,a.conv_6,[1,1]),f=eS(u,a.conv_7,[2,2]),l=ek(i,a.box_predictor_0),p=ek(o,a.box_predictor_1),d=ek(e,a.box_predictor_2),v=ek(r,a.box_predictor_3),m=ek(c,a.box_predictor_4),g=ek(f,a.box_predictor_5);return{boxPredictions:h.concat([l.boxPredictionEncoding,p.boxPredictionEncoding,d.boxPredictionEncoding,v.boxPredictionEncoding,m.boxPredictionEncoding,g.boxPredictionEncoding],1),classPredictions:h.concat([l.classPrediction,p.classPrediction,d.classPrediction,v.classPrediction,m.classPrediction,g.classPrediction],1)}})),l=f.boxPredictions,p=f.classPredictions;return s=e.output_layer,h.tidy(function(){var t,e,n,r,o,i,a,c,u,f,d,v,m,g=l.shape[0],y=(t=h.reshape(h.tile(s.extra_dim,[g,1,1]),[-1,4]),e=h.reshape(l,[-1,4]),a=(n=h.unstack(h.transpose(t,[1,0])),r=[h.sub(n[2],n[0]),h.sub(n[3],n[1])],o=[h.add(n[0],h.div(r[0],h.scalar(2))),h.add(n[1],h.div(r[1],h.scalar(2)))],i={sizes:r,centers:o}).sizes,c=i.centers,u=h.unstack(h.transpose(e,[1,0])),f=h.div(h.mul(h.exp(h.div(u[2],h.scalar(5))),a[0]),h.scalar(2)),d=h.add(h.mul(h.div(u[0],h.scalar(10)),a[0]),c[0]),v=h.div(h.mul(h.exp(h.div(u[3],h.scalar(5))),a[1]),h.scalar(2)),m=h.add(h.mul(h.div(u[1],h.scalar(10)),a[1]),c[1]),h.transpose(h.stack([h.sub(d,f),h.sub(m,v),h.add(d,f),h.add(m,v)]),[1,0]));y=h.reshape(y,[g,y.shape[0]/g,4]);var b=h.sigmoid(h.slice(p,[0,0,1],[-1,-1,-1])),w=h.slice(b,[0,0,0],[-1,-1,1]);return w=h.reshape(w,[g,w.shape[1]]),{boxes:h.unstack(y),scores:h.unstack(w)}})})},e.prototype.forward=function(t){return g(this,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:return e=this.forwardInput,[4,tk(t)];case 1:return[2,e.apply(this,[n.sent()])]}})})},e.prototype.locateFaces=function(t,e){return void 0===e&&(e={}),g(this,void 0,void 0,function(){var n,r,o,i,a,s,c,u,f,l,h,p,d,v,m,g,b,w,_,x;return y(this,function(y){switch(y.label){case 0:return r=(n=new eC(e)).maxResults,o=n.minConfidence,[4,tk(t)];case 1:for(i=y.sent(),s=(a=this.forwardInput(i)).boxes,c=a.scores,u=s[0],f=c[0],l=1;l<s.length;l++)s[l].dispose(),c[l].dispose();return d=(p=Array).from,[4,f.data()];case 2:var E,P,M,T,F,S;return h=d.apply(p,[y.sent()]),E=u,P=r,M=o,T=Math.min(P,E.shape[0]),F=h.map(function(t,e){return{score:t,boxIndex:e}}).filter(function(t){return t.score>M}).sort(function(t,e){return e.score-t.score}),S=[],F.forEach(function(t){if(!(S.length>=T)){for(var e=t.score,n=S.length-1;n>=0;--n){var r=function(t,e,n){var r=t.arraySync(),o=Math.min(r[e][0],r[e][2]),i=Math.min(r[e][1],r[e][3]),a=Math.max(r[e][0],r[e][2]),s=Math.max(r[e][1],r[e][3]),c=Math.min(r[n][0],r[n][2]),u=Math.min(r[n][1],r[n][3]),f=Math.max(r[n][0],r[n][2]),l=Math.max(r[n][1],r[n][3]),h=(a-o)*(s-i),p=(f-c)*(l-u);if(h<=0||p<=0)return 0;var d=Math.max(Math.min(a,f)-Math.max(o,c),0)*Math.max(Math.min(s,l)-Math.max(i,u),0);return d/(h+p-d)}(E,t.boxIndex,S[n]);if(0!==r&&(t.score*=r<=.5?1:0,t.score<=M))break}e===t.score&&S.push(t.boxIndex)}}),v=S,m=i.getReshapedInputDimensions(0),b=(g=i.inputSize)/m.width,w=g/m.height,_=u.arraySync(),x=v.map(function(t){var e=[Math.max(0,_[t][0]),Math.min(1,_[t][2])].map(function(t){return t*w}),n=e[0],r=e[1],o=[Math.max(0,_[t][1]),Math.min(1,_[t][3])].map(function(t){return t*b}),a=o[0],s=o[1];return new N(h[t],new Z(a,n,s-a,r-n),{height:i.getInputHeight(0),width:i.getInputWidth(0)})}),u.dispose(),f.dispose(),[2,x]}})})},e.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},e.prototype.extractParamsFromWeigthMap=function(t){return function(t){var e=[],n=function(t,e){var n=tX(t,e);function r(t,e,r){return{filters:n(t+"/Conv2d_"+e+"_pointwise/weights",4,r+"/filters"),batch_norm_offset:n(t+"/Conv2d_"+e+"_pointwise/convolution_bn_offset",1,r+"/batch_norm_offset")}}function o(t){var e="mobilenetv1/conv_"+t,o="MobilenetV1/Conv2d_"+t+"_depthwise",i=e+"/depthwise_conv";return{depthwise_conv:{filters:n(o+"/depthwise_weights",4,i+"/filters"),batch_norm_scale:n(o+"/BatchNorm/gamma",1,i+"/batch_norm_scale"),batch_norm_offset:n(o+"/BatchNorm/beta",1,i+"/batch_norm_offset"),batch_norm_mean:n(o+"/BatchNorm/moving_mean",1,i+"/batch_norm_mean"),batch_norm_variance:n(o+"/BatchNorm/moving_variance",1,i+"/batch_norm_variance")},pointwise_conv:r("MobilenetV1",t,e+"/pointwise_conv")}}function i(t,e){return{filters:n(t+"/weights",4,e+"/filters"),bias:n(t+"/biases",1,e+"/bias")}}function a(t){return{box_encoding_predictor:i("Prediction/BoxPredictor_"+t+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+t+"/box_encoding_predictor"),class_predictor:i("Prediction/BoxPredictor_"+t+"/ClassPredictor","prediction_layer/box_predictor_"+t+"/class_predictor")}}return{extractMobilenetV1Params:function(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:o(1),conv_2:o(2),conv_3:o(3),conv_4:o(4),conv_5:o(5),conv_6:o(6),conv_7:o(7),conv_8:o(8),conv_9:o(9),conv_10:o(10),conv_11:o(11),conv_12:o(12),conv_13:o(13)}},extractPredictionLayerParams:function(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:a(0),box_predictor_1:a(1),box_predictor_2:a(2),box_predictor_3:a(3),box_predictor_4:a(4),box_predictor_5:a(5)}}}}(t,e),r=n.extractMobilenetV1Params,o=n.extractPredictionLayerParams,i=t["Output/extra_dim"];if(e.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!P(i))throw Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var a={mobilenetv1:r(),prediction_layer:o(),output_layer:{extra_dim:i}};return tG(t,e),{params:a,paramMappings:e}}(t)},e.prototype.extractParams=function(t){return function(t){var e=[],n=t$(t),r=n.extractWeights,o=n.getRemainingWeights,i=function(t,e){function n(n,r,o,i,a){var s=h.tensor4d(t(n*r*o*o),[o,o,n,r]),c=h.tensor1d(t(r));return e.push({paramPath:i+"/filters"},{paramPath:i+"/"+(a?"batch_norm_offset":"bias")}),{filters:s,bias:c}}function r(t,e,r,o){var i=n(t,e,r,o,!0);return{filters:i.filters,batch_norm_offset:i.bias}}function o(n,o,i){var a,s,c,u,f,l;return{depthwise_conv:(a=i+"/depthwise_conv",s=h.tensor4d(t(9*n),[3,3,n,1]),c=h.tensor1d(t(n)),u=h.tensor1d(t(n)),f=h.tensor1d(t(n)),l=h.tensor1d(t(n)),e.push({paramPath:a+"/filters"},{paramPath:a+"/batch_norm_scale"},{paramPath:a+"/batch_norm_offset"},{paramPath:a+"/batch_norm_mean"},{paramPath:a+"/batch_norm_variance"}),{filters:s,batch_norm_scale:c,batch_norm_offset:u,batch_norm_mean:f,batch_norm_variance:l}),pointwise_conv:r(n,o,1,i+"/pointwise_conv")}}return{extractMobilenetV1Params:function(){return{conv_0:r(3,32,3,"mobilenetv1/conv_0"),conv_1:o(32,64,"mobilenetv1/conv_1"),conv_2:o(64,128,"mobilenetv1/conv_2"),conv_3:o(128,128,"mobilenetv1/conv_3"),conv_4:o(128,256,"mobilenetv1/conv_4"),conv_5:o(256,256,"mobilenetv1/conv_5"),conv_6:o(256,512,"mobilenetv1/conv_6"),conv_7:o(512,512,"mobilenetv1/conv_7"),conv_8:o(512,512,"mobilenetv1/conv_8"),conv_9:o(512,512,"mobilenetv1/conv_9"),conv_10:o(512,512,"mobilenetv1/conv_10"),conv_11:o(512,512,"mobilenetv1/conv_11"),conv_12:o(512,1024,"mobilenetv1/conv_12"),conv_13:o(1024,1024,"mobilenetv1/conv_13")}},extractPredictionLayerParams:function(){return{conv_0:r(1024,256,1,"prediction_layer/conv_0"),conv_1:r(256,512,3,"prediction_layer/conv_1"),conv_2:r(512,128,1,"prediction_layer/conv_2"),conv_3:r(128,256,3,"prediction_layer/conv_3"),conv_4:r(256,128,1,"prediction_layer/conv_4"),conv_5:r(128,256,3,"prediction_layer/conv_5"),conv_6:r(256,64,1,"prediction_layer/conv_6"),conv_7:r(64,128,3,"prediction_layer/conv_7"),box_predictor_0:{box_encoding_predictor:n(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),class_predictor:n(512,9,1,"prediction_layer/box_predictor_0/class_predictor")},box_predictor_1:{box_encoding_predictor:n(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),class_predictor:n(1024,18,1,"prediction_layer/box_predictor_1/class_predictor")},box_predictor_2:{box_encoding_predictor:n(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),class_predictor:n(512,18,1,"prediction_layer/box_predictor_2/class_predictor")},box_predictor_3:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_3/class_predictor")},box_predictor_4:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_4/class_predictor")},box_predictor_5:{box_encoding_predictor:n(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),class_predictor:n(128,18,1,"prediction_layer/box_predictor_5/class_predictor")}}}}}(r,e),a=i.extractMobilenetV1Params,s=i.extractPredictionLayerParams,c=a(),u=s(),f=h.tensor3d(r(20472),[1,5118,4]);if(e.push({paramPath:"output_layer/extra_dim"}),0!==o().length)throw Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:c,prediction_layer:u,output_layer:{extra_dim:f}},paramMappings:e}}(t)},e}(tN);function eD(t){var e=new eA;return e.extractWeights(t),e}function eO(t){return eD(t)}var eL=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e}(eA),eB=[new B(.738768,.874946),new B(2.42204,2.65704),new B(4.30971,7.04493),new B(10.246,4.59428),new B(12.6868,11.8741)],eI=[new B(1.603231,2.094468),new B(6.041143,7.080126),new B(2.882459,3.518061),new B(4.266906,5.178857),new B(9.041765,10.66308)],ej=[117.001,114.697,97.404],eR=function(t){return"number"==typeof t};function eN(t){if(!t)throw Error("invalid config: "+t);if("boolean"!=typeof t.withSeparableConvs)throw Error("config.withSeparableConvs has to be a boolean, have: "+t.withSeparableConvs);if(!eR(t.iouThreshold)||t.iouThreshold<0||t.iouThreshold>1)throw Error("config.iouThreshold has to be a number between [0, 1], have: "+t.iouThreshold);if(!Array.isArray(t.classes)||!t.classes.length||!t.classes.every(function(t){return"string"==typeof t}))throw Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(t.classes));if(!Array.isArray(t.anchors)||!t.anchors.length||!t.anchors.map(function(t){return t||{}}).every(function(t){return eR(t.x)&&eR(t.y)}))throw Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(t.anchors));if(t.meanRgb&&(!Array.isArray(t.meanRgb)||3!==t.meanRgb.length||!t.meanRgb.every(eR)))throw Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(t.meanRgb))}function eW(t){return h.tidy(function(){var e=h.mul(t,h.scalar(.10000000149011612));return h.add(h.relu(h.sub(t,e)),e)})}function ez(t,e){return h.tidy(function(){var n=h.pad(t,[[0,0],[1,1],[1,1],[0,0]]);return n=h.conv2d(n,e.conv.filters,[1,1],"valid"),n=h.sub(n,e.bn.sub),n=h.mul(n,e.bn.truediv),eW(n=h.add(n,e.conv.bias))})}function eU(t,e){return h.tidy(function(){var n=h.pad(t,[[0,0],[1,1],[1,1],[0,0]]);return n=h.separableConv2d(n,e.depthwise_filter,e.pointwise_filter,[1,1],"valid"),eW(n=h.add(n,e.bias))})}(i=u||(u={}))[i.XS=224]="XS",i[i.SM=320]="SM",i[i.MD=416]="MD",i[i.LG=608]="LG";var eV=function(){function t(t){var e=void 0===t?{}:t,n=e.inputSize,r=e.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=n||416,this._scoreThreshold=r||.5,"number"!=typeof this._inputSize||this._inputSize%32!=0)throw Error(this._name+" - expected inputSize to be a number divisible by 32");if("number"!=typeof this._scoreThreshold||this._scoreThreshold<=0||this._scoreThreshold>=1)throw Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),t}(),eG=function(t){function e(e){var n=t.call(this,"TinyYolov2")||this;return eN(e),n._config=e,n}return v(e,t),Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),e.prototype.runTinyYolov2=function(t,e){var n=ez(t,e.conv0);return n=ez(n=h.maxPool(n,[2,2],[2,2],"same"),e.conv1),n=ez(n=h.maxPool(n,[2,2],[2,2],"same"),e.conv2),n=ez(n=h.maxPool(n,[2,2],[2,2],"same"),e.conv3),n=ez(n=h.maxPool(n,[2,2],[2,2],"same"),e.conv4),n=ez(n=h.maxPool(n,[2,2],[2,2],"same"),e.conv5),n=ez(n=h.maxPool(n,[2,2],[1,1],"same"),e.conv6),tV(n=ez(n,e.conv7),e.conv8,"valid",!1)},e.prototype.runMobilenet=function(t,e){var n=this.config.isFirstLayerConv2d?eW(tV(t,e.conv0,"valid",!1)):eU(t,e.conv0);return n=eU(n=h.maxPool(n,[2,2],[2,2],"same"),e.conv1),n=eU(n=h.maxPool(n,[2,2],[2,2],"same"),e.conv2),n=eU(n=h.maxPool(n,[2,2],[2,2],"same"),e.conv3),n=eU(n=h.maxPool(n,[2,2],[2,2],"same"),e.conv4),n=eU(n=h.maxPool(n,[2,2],[2,2],"same"),e.conv5),n=h.maxPool(n,[2,2],[1,1],"same"),n=e.conv6?eU(n,e.conv6):n,tV(n=e.conv7?eU(n,e.conv7):n,e.conv8,"valid",!1)},e.prototype.forwardInput=function(t,e){var n=this,r=this.params;if(!r)throw Error("TinyYolov2 - load model before inference");return h.tidy(function(){var o=t.toBatchTensor(e,!1).toFloat();return o=(o=n.config.meanRgb?V(o,n.config.meanRgb):o).div(h.scalar(256)),n.config.withSeparableConvs?n.runMobilenet(o,r):n.runTinyYolov2(o,r)})},e.prototype.forward=function(t,e){return g(this,void 0,void 0,function(){var n;return y(this,function(r){switch(r.label){case 0:return n=this.forwardInput,[4,tk(t)];case 1:return[4,n.apply(this,[r.sent(),e])];case 2:return[2,r.sent()]}})})},e.prototype.detect=function(t,e){return void 0===e&&(e={}),g(this,void 0,void 0,function(){var n,r,o,i,a,s,c,u,f,l,p,d,v=this;return y(this,function(m){switch(m.label){case 0:return r=(n=new eV(e)).inputSize,o=n.scoreThreshold,[4,tk(t)];case 1:return i=m.sent(),[4,this.forwardInput(i,r)];case 2:return a=m.sent(),s=h.tidy(function(){return h.unstack(a)[0].expandDims()}),c={width:i.getInputWidth(0),height:i.getInputHeight(0)},[4,this.extractBoxes(s,i.getReshapedInputDimensions(0),o)];case 3:return u=m.sent(),a.dispose(),s.dispose(),f=u.map(function(t){return t.box}),l=u.map(function(t){return t.score}),p=u.map(function(t){return t.classScore}),d=u.map(function(t){return v.config.classes[t.label]}),[2,U(f.map(function(t){return t.rescale(r)}),l,this.config.iouThreshold,!0).map(function(t){return new R(l[t],p[t],d[t],f[t],c)})]}})})},e.prototype.getDefaultModelName=function(){return""},e.prototype.extractParamsFromWeigthMap=function(t){return function(t,e){var n,r=[],o=function(t,e){var n=tX(t,e);function r(t){return{filters:n(t+"/filters",4),bias:n(t+"/bias",1)}}return{extractConvParams:r,extractConvWithBatchNormParams:function(t){var e;return{conv:r(t+"/conv"),bn:{sub:n((e=t+"/bn")+"/sub",1),truediv:n(e+"/truediv",1)}}},extractSeparableConvParams:tq(n)}}(t,r),i=o.extractConvParams,a=o.extractConvWithBatchNormParams,s=o.extractSeparableConvParams;if(e.withSeparableConvs){var c=e.filterSizes&&e.filterSizes.length||9;n={conv0:e.isFirstLayerConv2d?i("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:c>7?s("conv6"):void 0,conv7:c>8?s("conv7"):void 0,conv8:i("conv8")}}else n={conv0:a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:a("conv6"),conv7:a("conv7"),conv8:i("conv8")};return tG(t,r),{params:n,paramMappings:r}}(t,this.config)},e.prototype.extractParams=function(t){var n=this.config.filterSizes||e.DEFAULT_FILTER_SIZES,r=n?n.length:void 0;if(7!==r&&8!==r&&9!==r)throw Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+r+" filterSizes in config");return function(t,e,n,r){var o,i,a=t$(t),s=a.extractWeights,c=a.getRemainingWeights,u=[],f={extractConvParams:o=tH(s,u),extractConvWithBatchNormParams:function(t,e,n){var r,i,a;return{conv:o(t,e,3,n+"/conv"),bn:(r=n+"/bn",i=h.tensor1d(s(e)),a=h.tensor1d(s(e)),u.push({paramPath:r+"/sub"},{paramPath:r+"/truediv"}),{sub:i,truediv:a})}},extractSeparableConvParams:tZ(s,u)},l=f.extractConvParams,p=f.extractConvWithBatchNormParams,d=f.extractSeparableConvParams;if(e.withSeparableConvs){var v=r[0],m=r[1],g=r[2],y=r[3],b=r[4],w=r[5],_=r[6],x=r[7],E=r[8],P=e.isFirstLayerConv2d?l(v,m,3,"conv0"):d(v,m,"conv0"),M=d(m,g,"conv1"),T=d(g,y,"conv2"),F=d(y,b,"conv3"),S=d(b,w,"conv4"),k=d(w,_,"conv5"),C=x?d(_,x,"conv6"):void 0,A=E?d(x,E,"conv7"):void 0,D=l(E||x||_,5*n,1,"conv8");i={conv0:P,conv1:M,conv2:T,conv3:F,conv4:S,conv5:k,conv6:C,conv7:A,conv8:D}}else{var v=r[0],m=r[1],g=r[2],y=r[3],b=r[4],w=r[5],_=r[6],x=r[7],E=r[8],P=p(v,m,"conv0"),M=p(m,g,"conv1"),T=p(g,y,"conv2"),F=p(y,b,"conv3"),S=p(b,w,"conv4"),k=p(w,_,"conv5"),C=p(_,x,"conv6"),A=p(x,E,"conv7"),D=l(E,5*n,1,"conv8");i={conv0:P,conv1:M,conv2:T,conv3:F,conv4:S,conv5:k,conv6:C,conv7:A,conv8:D}}if(0!==c().length)throw Error("weights remaing after extract: "+c().length);return{params:i,paramMappings:u}}(t,this.config,this.boxEncodingSize,n)},e.prototype.extractBoxes=function(t,e,n){return g(this,void 0,void 0,function(){var r,o,i,a,s,c,u,f,l,p,d,v,g,b,w,_,x,E,P,M,T,F,S,k,C,A,D,O,L,B=this;return y(this,function(y){switch(y.label){case 0:return a=(i=Math.max(r=e.width,o=e.height))/r,s=i/o,c=t.shape[1],u=this.config.anchors.length,l=(f=h.tidy(function(){var e=t.reshape([c,c,u,B.boxEncodingSize]);return[e.slice([0,0,0,0],[c,c,u,4]),e.slice([0,0,0,4],[c,c,u,1]),B.withClassScores?h.softmax(e.slice([0,0,0,5],[c,c,u,B.config.classes.length]),3):h.scalar(0)]}))[0],p=f[1],d=f[2],v=[],[4,p.array()];case 1:return g=y.sent(),[4,l.array()];case 2:b=y.sent(),w=0,y.label=3;case 3:if(!(w<c))return[3,12];_=0,y.label=4;case 4:if(!(_<c))return[3,11];x=0,y.label=5;case 5:if(!(x<u))return[3,10];if(E=Y(g[w][_][x][0]),!(!n||E>n))return[3,9];if(P=(_+Y(b[w][_][x][0]))/c*a,M=(w+Y(b[w][_][x][1]))/c*s,T=Math.exp(b[w][_][x][2])*this.config.anchors[x].x/c*a,F=Math.exp(b[w][_][x][3])*this.config.anchors[x].y/c*s,S=P-T/2,k=M-F/2,C={row:w,col:_,anchor:x},!this.withClassScores)return[3,7];return[4,this.extractPredictedClass(d,C)];case 6:return L=y.sent(),[3,8];case 7:L={classScore:1,label:0},y.label=8;case 8:D=(A=L).classScore,O=A.label,v.push(m({box:new j(S,k,S+T,k+F),score:E,classScore:E*D,label:O},C)),y.label=9;case 9:return x++,[3,5];case 10:return _++,[3,4];case 11:return w++,[3,3];case 12:return l.dispose(),p.dispose(),d.dispose(),[2,v]}})})},e.prototype.extractPredictedClass=function(t,e){return g(this,void 0,void 0,function(){var n,r,o,i;return y(this,function(a){switch(a.label){case 0:return n=e.row,r=e.col,o=e.anchor,[4,t.array()];case 1:return i=a.sent(),[2,Array(this.config.classes.length).fill(0).map(function(t,e){return i[n][r][o][e]}).map(function(t,e){return{classScore:t,label:e}}).reduce(function(t,e){return t.classScore>e.classScore?t:e})]}})})},e.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],e}(tN),eH=function(t){function e(e){void 0===e&&(e=!0);var n=Object.assign({},{withSeparableConvs:e,iouThreshold:.4,classes:["face"]},e?{anchors:eI,meanRgb:ej}:{anchors:eB,withClassScores:!0});return t.call(this,n)||this}return v(e,t),Object.defineProperty(e.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(t,e){return g(this,void 0,void 0,function(){return y(this,function(n){switch(n.label){case 0:return[4,this.detect(t,e)];case 1:return[2,n.sent().map(function(t){return new N(t.score,t.relativeBox,{width:t.imageWidth,height:t.imageHeight})})]}})})},e.prototype.getDefaultModelName=function(){return this.withSeparableConvs?"tiny_yolov2_separable_conv_model":"tiny_yolov2_model"},e.prototype.extractParamsFromWeigthMap=function(e){return t.prototype.extractParamsFromWeigthMap.call(this,e)},e}(eG);function eY(t,e){void 0===e&&(e=!0);var n=new eH(e);return n.extractWeights(t),n}var eJ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._name="TinyFaceDetectorOptions",e}return v(e,t),e}(eV),eZ=function(){function t(){}return t.prototype.then=function(t){return g(this,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:return e=t,[4,this.run()];case 1:return[2,e.apply(void 0,[n.sent()])]}})})},t.prototype.run=function(){return g(this,void 0,void 0,function(){return y(this,function(t){throw Error("ComposableTask - run is not implemented")})})},t}();function eq(t,e,n,r,o){return void 0===o&&(o=function(t){return t.alignedRect}),g(this,void 0,void 0,function(){var i,a,s,c,u;return y(this,function(f){switch(f.label){case 0:if(i=t.map(function(t){return ee(t)?o(t):t.detection}),s=r)return[3,5];if(!(e instanceof h.Tensor))return[3,2];return[4,tA(e,i)];case 1:return c=f.sent(),[3,4];case 2:return[4,tC(e,i)];case 3:c=f.sent(),f.label=4;case 4:s=c,f.label=5;case 5:return[4,n(a=s)];case 6:return u=f.sent(),a.forEach(function(t){return t instanceof h.Tensor&&t.dispose()}),[2,u]}})})}function eX(t,e,n,r,o){return g(this,void 0,void 0,function(){var i=this;return y(this,function(a){return[2,eq([t],e,function(t){return g(i,void 0,void 0,function(){return y(this,function(e){return[2,n(t[0])]})})},r,o)]})})}function e$(t,e){return{height:Math.floor(e[0]*t),width:Math.floor(e[1]*t)}}var eK=function(t){function e(e,n,r,o){return t.call(this,{left:e,top:n,right:r,bottom:o},!0)||this}return v(e,t),e}(I);function eQ(t){return h.tidy(function(){return h.mul(h.sub(t,h.scalar(127.5)),h.scalar(.0078125))})}function e0(t,e){return h.tidy(function(){return h.add(h.relu(t),h.mul(e,h.neg(h.relu(h.neg(t)))))})}function e1(t,e,n){return void 0===n&&(n=!1),h.tidy(function(){var r=tV(t,e.conv1,"valid");return r=e0(r,e.prelu1_alpha),r=e0(r=tV(r=h.maxPool(r,n?[2,2]:[3,3],[2,2],"same"),e.conv2,"valid"),e.prelu2_alpha),r=e0(r=tV(r=n?r:h.maxPool(r,[3,3],[2,2],"valid"),e.conv3,"valid"),e.prelu3_alpha)})}function e2(t,e,n){var r=n.width,o=n.height;return g(this,void 0,void 0,function(){var n,i,a,s=this;return y(this,function(c){switch(c.label){case 0:return n=tp(t),[4,Promise.all(e.map(function(e){return g(s,void 0,void 0,function(){var r,o,i,a,s,c,u,f;return y(this,function(l){return o=(r=e.padAtBorders(t.height,t.width)).y,i=r.ey,a=r.x,s=r.ex,c=a-1,u=o-1,f=n.getImageData(c,u,s-c,i-u),[2,tl.isNodejs()?tP(f):createImageBitmap(f)]})})}))];case 1:return i=c.sent(),a=[],i.forEach(function(t){var e=tp(tE({width:r,height:o}));e.drawImage(t,0,0,r,o);for(var n=e.getImageData(0,0,r,o).data,i=[],s=0;s<n.length;s+=4)i.push(n[s+2]),i.push(n[s+1]),i.push(n[s]);a.push(i)}),[2,a.map(function(t){return h.tidy(function(){return eQ(h.transpose(h.tensor4d(t,[1,r,o,3]),[0,2,1,3]).toFloat())})})]}})})}var e5=function(t){function e(){return t.call(this,"Mtcnn")||this}return v(e,t),e.prototype.load=function(e){return g(this,void 0,void 0,function(){return y(this,function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,t.prototype.load.call(this,e)]})})},e.prototype.loadFromDisk=function(e){return g(this,void 0,void 0,function(){return y(this,function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,t.prototype.loadFromDisk.call(this,e)]})})},e.prototype.forwardInput=function(t,e){return void 0===e&&(e={}),g(this,void 0,void 0,function(){var n,r,o,i,a,s,c,u,f,l,p,d,v,m,b,w,_,x,E,P;return y(this,function(M){switch(M.label){case 0:if(!(n=this.params))throw Error("Mtcnn - load model before inference");if(!(r=t.canvases[0]))throw Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return o={},i=Date.now(),a=h.tidy(function(){var t;return t=h.expandDims(h.browser.fromPixels(r)).toFloat(),h.tidy(function(){return h.stack(h.unstack(t,3).reverse(),3)})}),s=function(t){return a.dispose(),o.total=Date.now()-i,t},u=(c=a.shape.slice(1))[0],f=c[1],p=(l=new eF(e)).minFaceSize,d=l.scaleFactor,v=l.maxNumScales,m=l.scoreThresholds,b=(l.scaleSteps||function(t,e,n){for(var r=n[0],o=n[1],i=12/t,a=[],s=Math.min(r,o)*i,c=0;s>=12;)a.push(i*Math.pow(e,c)),s*=e,c+=1;return a}(p,d,[u,f])).filter(function(t){var e=e$(t,[u,f]);return Math.min(e.width,e.height)>12}).slice(0,v),o.scales=b,o.pyramid=b.map(function(t){return e$(t,[u,f])}),w=Date.now(),[4,function(t,e,n,r,o){o.stage1=[];var i=e.map(function(e){return h.tidy(function(){var n={scale:e},o=h.tidy(function(){var n=e$(e,t.shape.slice(1)),r=n.height,o=n.width,i=eQ(h.image.resizeBilinear(t,[r,o]));return h.transpose(i,[0,2,1,3])}),i=Date.now(),a=h.tidy(function(){var t=e1(o,r,!0),e=tV(t,r.conv4_1,"valid"),n=h.expandDims(h.max(e,3),3);return{prob:h.softmax(h.sub(e,n),3),regions:tV(t,r.conv4_2,"valid")}}),s=a.prob,c=a.regions;return n.pnet=Date.now()-i,{scoresTensor:h.unstack(h.unstack(s,3)[1])[0],regionsTensor:h.unstack(c)[0],scale:e,statsForScale:n}})}).map(function(t){var e=t.scoresTensor,r=t.regionsTensor,i=t.scale,a=t.statsForScale,s=function(t,e,n,r){for(var o=[],i=t.arraySync(),a=0;a<t.shape[0];a++)for(var s=0;s<t.shape[1];s++)i[a][s]>=r&&o.push(new B(s,a));return o.map(function(t){var r=new j(Math.round((2*t.y+1)/n),Math.round((2*t.x+1)/n),Math.round((2*t.y+12)/n),Math.round((2*t.x+12)/n)),o=i[t.y][t.x],a=e.arraySync();return{cell:r,score:o,region:new eK(a[t.y][t.x][0],a[t.y][t.x][1],a[t.y][t.x][2],a[t.y][t.x][3])}})}(e,r,i,n);if(e.dispose(),r.dispose(),!s.length)return o.stage1.push(a),[];var c=Date.now(),u=U(s.map(function(t){return t.cell}),s.map(function(t){return t.score}),.5);return a.nms=Date.now()-c,a.numBoxes=u.length,o.stage1.push(a),u.map(function(t){return s[t]})}).reduce(function(t,e){return t.concat(e)},[]),a=[],s=[];if(i.length>0){var c=Date.now(),u=U(i.map(function(t){return t.cell}),i.map(function(t){return t.score}),.7);o.stage1_nms=Date.now()-c,s=u.map(function(t){return i[t].score}),a=u.map(function(t){return i[t]}).map(function(t){var e=t.cell,n=t.region;return new j(e.left+n.left*e.width,e.top+n.top*e.height,e.right+n.right*e.width,e.bottom+n.bottom*e.height).toSquare().round()})}return{boxes:a,scores:s}}(a,b,m[0],n.pnet,o)];case 1:if(_=M.sent(),o.total_stage1=Date.now()-w,!_.boxes.length)return[2,s({results:[],stats:o})];return o.stage2_numInputBoxes=_.boxes.length,w=Date.now(),[4,function(t,e,n,r,o){return g(this,void 0,void 0,function(){var i,a,s,c,u,f,l,p,d,v,m,g,b,w;return y(this,function(y){switch(y.label){case 0:return i=Date.now(),[4,e2(t,e,{width:24,height:24})];case 1:return a=y.sent(),o.stage2_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(t){var e=h.tidy(function(){var e=e1(t,r),n=e0(t2(h.reshape(e,[e.shape[0],r.fc1.weights.shape[0]]),r.fc1),r.prelu4_alpha),o=t2(n,r.fc2_1),i=h.expandDims(h.max(o,1),1),a=h.softmax(h.sub(o,i),1),s=t2(n,r.fc2_2);return{scores:h.unstack(a,1)[1],regions:s}});return t.dispose(),e}),o.stage2_rnet=Date.now()-i,c=s.length>1?h.concat(s.map(function(t){return t.scores})):s[0].scores,l=(f=Array).from,[4,c.data()];case 2:return u=l.apply(f,[y.sent()]),c.dispose(),d=(p=u.map(function(t,e){return{score:t,idx:e}}).filter(function(t){return t.score>n}).map(function(t){return t.idx})).map(function(t){return e[t]}),v=p.map(function(t){return u[t]}),m=[],g=[],d.length>0&&(i=Date.now(),b=U(d,v,.7),o.stage2_nms=Date.now()-i,w=b.map(function(t){var e=s[p[t]].regions.arraySync();return new eK(e[0][0],e[0][1],e[0][2],e[0][3])}),g=b.map(function(t){return v[t]}),m=b.map(function(t,e){return d[t].calibrate(w[e])})),s.forEach(function(t){t.regions.dispose(),t.scores.dispose()}),[2,{boxes:m,scores:g}]}})})}(r,_.boxes,m[1],n.rnet,o)];case 2:if(x=M.sent(),o.total_stage2=Date.now()-w,!x.boxes.length)return[2,s({results:[],stats:o})];return o.stage3_numInputBoxes=x.boxes.length,w=Date.now(),[4,function(t,e,n,r,o){return g(this,void 0,void 0,function(){var i,a,s,c,u,f,l,p,d,v,m,g,b,w,_;return y(this,function(y){switch(y.label){case 0:return i=Date.now(),[4,e2(t,e,{width:48,height:48})];case 1:return a=y.sent(),o.stage3_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(t){var e=h.tidy(function(){var e=e1(t,r);e=e0(e=tV(e=h.maxPool(e,[2,2],[2,2],"same"),r.conv4,"valid"),r.prelu4_alpha);var n=e0(t2(h.reshape(e,[e.shape[0],r.fc1.weights.shape[0]]),r.fc1),r.prelu5_alpha),o=t2(n,r.fc2_1),i=h.expandDims(h.max(o,1),1),a=h.softmax(h.sub(o,i),1),s=t2(n,r.fc2_2),c=t2(n,r.fc2_3);return{scores:h.unstack(a,1)[1],regions:s,points:c}});return t.dispose(),e}),o.stage3_onet=Date.now()-i,c=s.length>1?h.concat(s.map(function(t){return t.scores})):s[0].scores,l=(f=Array).from,[4,c.data()];case 2:return u=l.apply(f,[y.sent()]),c.dispose(),d=(p=u.map(function(t,e){return{score:t,idx:e}}).filter(function(t){return t.score>n}).map(function(t){return t.idx})).map(function(t){var e=s[t].regions.arraySync();return new eK(e[0][0],e[0][1],e[0][2],e[0][3])}),v=p.map(function(t,n){return e[t].calibrate(d[n])}),m=p.map(function(t){return u[t]}),g=[],b=[],w=[],v.length>0&&(i=Date.now(),_=U(v,m,.7,!1),o.stage3_nms=Date.now()-i,g=_.map(function(t){return v[t]}),b=_.map(function(t){return m[t]}),w=_.map(function(t,e){return[,,,,,].fill(0).map(function(n,r){var o=s[t].points.arraySync();return new B(o[0][r]*(g[e].width+1)+g[e].left,o[0][r+5]*(g[e].height+1)+g[e].top)})})),s.forEach(function(t){t.regions.dispose(),t.scores.dispose(),t.points.dispose()}),[2,{boxes:g,scores:b,points:w}]}})})}(r,x.boxes,m[2],n.onet,o)];case 3:return E=M.sent(),o.total_stage3=Date.now()-w,P=E.boxes.map(function(t,e){return en(tr({},new N(E.scores[e],new Z(t.left/f,t.top/u,t.width/f,t.height/u),{height:u,width:f})),new X(E.points[e].map(function(e){return e.sub(new B(t.left,t.top)).div(new B(t.width,t.height))}),{width:t.width,height:t.height}))}),[2,s({results:P,stats:o})]}})})},e.prototype.forward=function(t,e){return void 0===e&&(e={}),g(this,void 0,void 0,function(){var n;return y(this,function(r){switch(r.label){case 0:return n=this.forwardInput,[4,tk(t)];case 1:return[4,n.apply(this,[r.sent(),e])];case 2:return[2,r.sent().results]}})})},e.prototype.forwardWithStats=function(t,e){return void 0===e&&(e={}),g(this,void 0,void 0,function(){var n;return y(this,function(r){switch(r.label){case 0:return n=this.forwardInput,[4,tk(t)];case 1:return[2,n.apply(this,[r.sent(),e])]}})})},e.prototype.getDefaultModelName=function(){return"mtcnn_model"},e.prototype.extractParamsFromWeigthMap=function(t){var e,n,r,o,i,a,s,c;return r=(n=function(t,e){var n=tX(t,e);function r(t){return{filters:n(t+"/weights",4,t+"/filters"),bias:n(t+"/bias",1)}}function o(t){return{weights:n(t+"/weights",2),bias:n(t+"/bias",1)}}function i(t){return{conv1:r(t+"/conv1"),prelu1_alpha:n(t+"/prelu1_alpha",1),conv2:r(t+"/conv2"),prelu2_alpha:n(t+"/prelu2_alpha",1),conv3:r(t+"/conv3"),prelu3_alpha:n(t+"/prelu3_alpha",1)}}return{extractPNetParams:function(){var t=i("pnet"),e=r("pnet/conv4_1"),n=r("pnet/conv4_2");return m(m({},t),{conv4_1:e,conv4_2:n})},extractRNetParams:function(){var t=i("rnet"),e=o("rnet/fc1"),r=n("rnet/prelu4_alpha",1),a=o("rnet/fc2_1"),s=o("rnet/fc2_2");return m(m({},t),{fc1:e,prelu4_alpha:r,fc2_1:a,fc2_2:s})},extractONetParams:function(){var t=i("onet"),e=r("onet/conv4"),a=n("onet/prelu4_alpha",1),s=o("onet/fc1"),c=n("onet/prelu5_alpha",1),u=o("onet/fc2_1"),f=o("onet/fc2_2"),l=o("onet/fc2_3");return m(m({},t),{conv4:e,prelu4_alpha:a,fc1:s,prelu5_alpha:c,fc2_1:u,fc2_2:f,fc2_3:l})}}}(t,e=[])).extractPNetParams,o=n.extractRNetParams,i=n.extractONetParams,a=r(),s=o(),c=i(),tG(t,e),{params:{pnet:a,rnet:s,onet:c},paramMappings:e}},e.prototype.extractParams=function(t){return function(t){var e=t$(t),n=e.extractWeights,r=e.getRemainingWeights,o=[],i=function(t,e){var n=tH(t,e),r=tY(t,e);function o(n,r){var o=h.tensor1d(t(n));return e.push({paramPath:r}),o}function i(t,e,r){return void 0===r&&(r=!1),{conv1:n(t[0],t[1],3,e+"/conv1"),prelu1_alpha:o(t[1],e+"/prelu1_alpha"),conv2:n(t[1],t[2],3,e+"/conv2"),prelu2_alpha:o(t[2],e+"/prelu2_alpha"),conv3:n(t[2],t[3],r?2:3,e+"/conv3"),prelu3_alpha:o(t[3],e+"/prelu3_alpha")}}return{extractPNetParams:function(){var t=i([3,10,16,32],"pnet"),e=n(32,2,1,"pnet/conv4_1"),r=n(32,4,1,"pnet/conv4_2");return m(m({},t),{conv4_1:e,conv4_2:r})},extractRNetParams:function(){var t=i([3,28,48,64],"rnet",!0),e=r(576,128,"rnet/fc1"),n=o(128,"rnet/prelu4_alpha"),a=r(128,2,"rnet/fc2_1"),s=r(128,4,"rnet/fc2_2");return m(m({},t),{fc1:e,prelu4_alpha:n,fc2_1:a,fc2_2:s})},extractONetParams:function(){var t=i([3,32,64,64],"onet"),e=n(64,128,2,"onet/conv4"),a=o(128,"onet/prelu4_alpha"),s=r(1152,256,"onet/fc1"),c=o(256,"onet/prelu5_alpha"),u=r(256,2,"onet/fc2_1"),f=r(256,4,"onet/fc2_2"),l=r(256,10,"onet/fc2_3");return m(m({},t),{conv4:e,prelu4_alpha:a,fc1:s,prelu5_alpha:c,fc2_1:u,fc2_2:f,fc2_3:l})}}}(n,o),a=i.extractPNetParams,s=i.extractRNetParams,c=i.extractONetParams,u=a(),f=s(),l=c();if(0!==r().length)throw Error("weights remaing after extract: "+r().length);return{params:{pnet:u,rnet:f,onet:l},paramMappings:o}}(t)},e}(tN),e4=[new B(1.603231,2.094468),new B(6.041143,7.080126),new B(2.882459,3.518061),new B(4.266906,5.178857),new B(9.041765,10.66308)],e3=[117.001,114.697,97.404],e6=function(t){function e(){return t.call(this,{withSeparableConvs:!0,iouThreshold:.4,classes:["face"],anchors:e4,meanRgb:e3,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]})||this}return v(e,t),Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(t,e){return g(this,void 0,void 0,function(){return y(this,function(n){switch(n.label){case 0:return[4,this.detect(t,e)];case 1:return[2,n.sent().map(function(t){return new N(t.score,t.relativeBox,{width:t.imageWidth,height:t.imageHeight})})]}})})},e.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},e.prototype.extractParamsFromWeigthMap=function(e){return t.prototype.extractParamsFromWeigthMap.call(this,e)},e}(eG),e8={ssdMobilenetv1:new eA,tinyFaceDetector:new e6,tinyYolov2:new eH,mtcnn:new e5,faceLandmark68Net:new el,faceLandmark68TinyNet:new ep,faceRecognitionNet:new ew,faceExpressionNet:new t8,ageGenderNet:new eu},e7=function(t,e){return e8.ssdMobilenetv1.locateFaces(t,e)},e9=function(t,e){return e8.tinyFaceDetector.locateFaces(t,e)},nt=function(t,e){return e8.tinyYolov2.locateFaces(t,e)},ne=function(t,e){return e8.mtcnn.forward(t,e)},nn=function(t){return e8.faceLandmark68Net.detectLandmarks(t)},nr=function(t){return e8.faceLandmark68TinyNet.detectLandmarks(t)},no=function(t){return e8.faceRecognitionNet.computeFaceDescriptor(t)},ni=function(t){return e8.faceExpressionNet.predictExpressions(t)},na=function(t){return e8.ageGenderNet.predictAgeAndGender(t)},ns=function(t){return e8.ssdMobilenetv1.load(t)},nc=function(t){return e8.tinyFaceDetector.load(t)},nu=function(t){return e8.mtcnn.load(t)},nf=function(t){return e8.tinyYolov2.load(t)},nl=function(t){return e8.faceLandmark68Net.load(t)},nh=function(t){return e8.faceLandmark68TinyNet.load(t)},np=function(t){return e8.faceRecognitionNet.load(t)},nd=function(t){return e8.faceExpressionNet.load(t)},nv=function(t){return e8.ageGenderNet.load(t)},nm=ns,ng=e7,ny=nn,nb=function(t){function e(e,n,r){var o=t.call(this)||this;return o.parentTask=e,o.input=n,o.extractedFaces=r,o}return v(e,t),e}(eZ),nw=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e.prototype.run=function(){return g(this,void 0,void 0,function(){var t,e,n=this;return y(this,function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return[4,eq(t=r.sent(),this.input,function(t){return g(n,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,Promise.all(t.map(function(t){return e8.faceExpressionNet.predictExpressions(t)}))];case 1:return[2,e.sent()]}})})},this.extractedFaces)];case 2:return e=r.sent(),[2,t.map(function(t,n){return t9(t,e[n])})]}})})},e.prototype.withAgeAndGender=function(){return new nM(this,this.input)},e}(nb),n_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e.prototype.run=function(){return g(this,void 0,void 0,function(){var t,e;return y(this,function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:if(!(t=n.sent()))return[2];return[4,eX(t,this.input,function(t){return e8.faceExpressionNet.predictExpressions(t)},this.extractedFaces)];case 2:return e=n.sent(),[2,t9(t,e)]}})})},e.prototype.withAgeAndGender=function(){return new nT(this,this.input)},e}(nb),nx=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e.prototype.withAgeAndGender=function(){return new nF(this,this.input)},e.prototype.withFaceDescriptors=function(){return new nC(this,this.input)},e}(nw),nE=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e.prototype.withAgeAndGender=function(){return new nS(this,this.input)},e.prototype.withFaceDescriptor=function(){return new nA(this,this.input)},e}(n_),nP=function(t){function e(e,n,r){var o=t.call(this)||this;return o.parentTask=e,o.input=n,o.extractedFaces=r,o}return v(e,t),e}(eZ),nM=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e.prototype.run=function(){return g(this,void 0,void 0,function(){var t,e,n=this;return y(this,function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return[4,eq(t=r.sent(),this.input,function(t){return g(n,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,Promise.all(t.map(function(t){return e8.ageGenderNet.predictAgeAndGender(t)}))];case 1:return[2,e.sent()]}})})},this.extractedFaces)];case 2:return e=r.sent(),[2,t.map(function(t,n){var r=e[n],o=r.age;return eP(eT(t,r.gender,r.genderProbability),o)})]}})})},e.prototype.withFaceExpressions=function(){return new nw(this,this.input)},e}(nP),nT=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e.prototype.run=function(){return g(this,void 0,void 0,function(){var t,e,n,r,o;return y(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:if(!(t=i.sent()))return[2];return[4,eX(t,this.input,function(t){return e8.ageGenderNet.predictAgeAndGender(t)},this.extractedFaces)];case 2:return n=(e=i.sent()).age,r=e.gender,o=e.genderProbability,[2,eP(eT(t,r,o),n)]}})})},e.prototype.withFaceExpressions=function(){return new n_(this,this.input)},e}(nP),nF=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e.prototype.withFaceExpressions=function(){return new nx(this,this.input)},e.prototype.withFaceDescriptors=function(){return new nC(this,this.input)},e}(nM),nS=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e.prototype.withFaceExpressions=function(){return new nE(this,this.input)},e.prototype.withFaceDescriptor=function(){return new nA(this,this.input)},e}(nT),nk=function(t){function e(e,n){var r=t.call(this)||this;return r.parentTask=e,r.input=n,r}return v(e,t),e}(eZ),nC=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e.prototype.run=function(){return g(this,void 0,void 0,function(){var t;return y(this,function(e){switch(e.label){case 0:return[4,this.parentTask];case 1:return[4,eq(t=e.sent(),this.input,function(t){return Promise.all(t.map(function(t){return e8.faceRecognitionNet.computeFaceDescriptor(t)}))},null,function(t){return t.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return[2,e.sent().map(function(e,n){return ex(t[n],e)})]}})})},e.prototype.withFaceExpressions=function(){return new nx(this,this.input)},e.prototype.withAgeAndGender=function(){return new nF(this,this.input)},e}(nk),nA=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e.prototype.run=function(){return g(this,void 0,void 0,function(){var t,e;return y(this,function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:if(!(t=n.sent()))return[2];return[4,eX(t,this.input,function(t){return e8.faceRecognitionNet.computeFaceDescriptor(t)},null,function(t){return t.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return e=n.sent(),[2,ex(t,e)]}})})},e.prototype.withFaceExpressions=function(){return new nE(this,this.input)},e.prototype.withAgeAndGender=function(){return new nS(this,this.input)},e}(nk),nD=function(t){function e(e,n,r){var o=t.call(this)||this;return o.parentTask=e,o.input=n,o.useTinyLandmarkNet=r,o}return v(e,t),Object.defineProperty(e.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?e8.faceLandmark68TinyNet:e8.faceLandmark68Net},enumerable:!0,configurable:!0}),e}(eZ),nO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e.prototype.run=function(){return g(this,void 0,void 0,function(){var t,e,n,r,o,i=this;return y(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:if(e=(t=a.sent()).map(function(t){return t.detection}),!(this.input instanceof h.Tensor))return[3,3];return[4,tA(this.input,e)];case 2:return r=a.sent(),[3,5];case 3:return[4,tC(this.input,e)];case 4:r=a.sent(),a.label=5;case 5:return[4,Promise.all((n=r).map(function(t){return i.landmarkNet.detectLandmarks(t)}))];case 6:return o=a.sent(),n.forEach(function(t){return t instanceof h.Tensor&&t.dispose()}),[2,t.map(function(t,e){return en(t,o[e])})]}})})},e.prototype.withFaceExpressions=function(){return new nx(this,this.input)},e.prototype.withAgeAndGender=function(){return new nF(this,this.input)},e.prototype.withFaceDescriptors=function(){return new nC(this,this.input)},e}(nD),nL=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e.prototype.run=function(){return g(this,void 0,void 0,function(){var t,e,n,r,o;return y(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:if(!(t=i.sent()))return[2];if(e=t.detection,!(this.input instanceof h.Tensor))return[3,3];return[4,tA(this.input,[e])];case 2:return r=i.sent(),[3,5];case 3:return[4,tC(this.input,[e])];case 4:r=i.sent(),i.label=5;case 5:return n=r,[4,this.landmarkNet.detectLandmarks(n[0])];case 6:return o=i.sent(),n.forEach(function(t){return t instanceof h.Tensor&&t.dispose()}),[2,en(t,o)]}})})},e.prototype.withFaceExpressions=function(){return new nE(this,this.input)},e.prototype.withAgeAndGender=function(){return new nS(this,this.input)},e.prototype.withFaceDescriptor=function(){return new nA(this,this.input)},e}(nD),nB=function(t){function e(e,n){void 0===n&&(n=new eC);var r=t.call(this)||this;return r.input=e,r.options=n,r}return v(e,t),e}(eZ),nI=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e.prototype.run=function(){return g(this,void 0,void 0,function(){var t,e,n,r;return y(this,function(o){switch(o.label){case 0:if(t=this,e=t.input,!((n=t.options)instanceof eF))return[3,2];return[4,e8.mtcnn.forward(e,n)];case 1:return[2,o.sent().map(function(t){return t.detection})];case 2:if(!(r=n instanceof eJ?function(t){return e8.tinyFaceDetector.locateFaces(t,n)}:n instanceof eC?function(t){return e8.ssdMobilenetv1.locateFaces(t,n)}:n instanceof eV?function(t){return e8.tinyYolov2.locateFaces(t,n)}:null))throw Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,r(e)]}})})},e.prototype.runAndExtendWithFaceDetections=function(){var t=this;return new Promise(function(e){return g(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.run()];case 1:return[2,e(t.sent().map(function(t){return tr({},t)}))]}})})})},e.prototype.withFaceLandmarks=function(t){return void 0===t&&(t=!1),new nO(this.runAndExtendWithFaceDetections(),this.input,t)},e.prototype.withFaceExpressions=function(){return new nw(this.runAndExtendWithFaceDetections(),this.input)},e.prototype.withAgeAndGender=function(){return new nM(this.runAndExtendWithFaceDetections(),this.input)},e}(nB),nj=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e.prototype.run=function(){return g(this,void 0,void 0,function(){var t,e;return y(this,function(n){switch(n.label){case 0:return[4,new nI(this.input,this.options)];case 1:return e=(t=n.sent())[0],t.forEach(function(t){t.score>e.score&&(e=t)}),[2,e]}})})},e.prototype.runAndExtendWithFaceDetection=function(){var t=this;return new Promise(function(e){return g(t,void 0,void 0,function(){var t;return y(this,function(n){switch(n.label){case 0:return[4,this.run()];case 1:return[2,e((t=n.sent())?tr({},t):void 0)]}})})})},e.prototype.withFaceLandmarks=function(t){return void 0===t&&(t=!1),new nL(this.runAndExtendWithFaceDetection(),this.input,t)},e.prototype.withFaceExpressions=function(){return new n_(this.runAndExtendWithFaceDetection(),this.input)},e.prototype.withAgeAndGender=function(){return new nT(this.runAndExtendWithFaceDetection(),this.input)},e}(nB);function nR(t,e){return void 0===e&&(e=new eC),new nj(t,e)}function nN(t,e){return void 0===e&&(e=new eC),new nI(t,e)}function nW(t,e){return g(this,void 0,void 0,function(){return y(this,function(n){switch(n.label){case 0:return console.warn("allFacesSsdMobilenetv1 is deprecated and will be removed soon, use the high level api instead"),[4,nN(t,new eC(e?{minConfidence:e}:{})).withFaceLandmarks().withFaceDescriptors()];case 1:return[2,n.sent()]}})})}function nz(t,e){return void 0===e&&(e={}),g(this,void 0,void 0,function(){return y(this,function(n){switch(n.label){case 0:return console.warn("allFacesTinyYolov2 is deprecated and will be removed soon, use the high level api instead"),[4,nN(t,new eV(e)).withFaceLandmarks().withFaceDescriptors()];case 1:return[2,n.sent()]}})})}function nU(t,e){return void 0===e&&(e={}),g(this,void 0,void 0,function(){return y(this,function(n){switch(n.label){case 0:return console.warn("allFacesMtcnn is deprecated and will be removed soon, use the high level api instead"),[4,nN(t,new eF(e)).withFaceLandmarks().withFaceDescriptors()];case 1:return[2,n.sent()]}})})}var nV=nW;function nG(t,e){if(t.length!==e.length)throw Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(t),r=Array.from(e);return Math.sqrt(n.map(function(t,e){return t-r[e]}).reduce(function(t,e){return t+Math.pow(e,2)},0))}var nH=function(){function t(t,e){void 0===e&&(e=.6),this._distanceThreshold=e;var n=Array.isArray(t)?t:[t];if(!n.length)throw Error("FaceRecognizer.constructor - expected atleast one input");var r=1,o=function(){return"person "+r++};this._labeledDescriptors=n.map(function(t){if(t instanceof tt)return t;if(t instanceof Float32Array)return new tt(o(),[t]);if(t.descriptor&&t.descriptor instanceof Float32Array)return new tt(o(),[t.descriptor]);throw Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(t.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),t.prototype.computeMeanDistance=function(t,e){return e.map(function(e){return nG(e,t)}).reduce(function(t,e){return t+e},0)/(e.length||1)},t.prototype.matchDescriptor=function(t){var e=this;return this.labeledDescriptors.map(function(n){var r=n.descriptors;return new K(n.label,e.computeMeanDistance(t,r))}).reduce(function(t,e){return t.distance<e.distance?t:e})},t.prototype.findBestMatch=function(t){var e=this.matchDescriptor(t);return e.distance<this.distanceThreshold?e:new K("unknown",e.distance)},t.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},t.fromJSON=function(e){return new t(e.labeledDescriptors.map(function(t){return tt.fromJSON(t)}),e.distanceThreshold)},t}();function nY(t){var e=new e5;return e.extractWeights(t),e}function nJ(t){var e=new e6;return e.extractWeights(t),e}},4184:function(t,e){var n;/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var t=[],e=0;e<arguments.length;e++){var n=arguments[e];if(n){var i=typeof n;if("string"===i||"number"===i)t.push(n);else if(Array.isArray(n)){if(n.length){var a=o.apply(null,n);a&&t.push(a)}}else if("object"===i){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){t.push(n.toString());continue}for(var s in n)r.call(n,s)&&n[s]&&t.push(s)}}}return t.join(" ")}t.exports?(o.default=o,t.exports=o):void 0!==(n=(function(){return o}).apply(e,[]))&&(t.exports=n)}()},3454:function(t,e,n){"use strict";var r,o;t.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(o=n.g.process)?void 0:o.env)?n.g.process:n(7663)},3271:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"Image",{enumerable:!0,get:function(){return Image}});let r=n(8754),o=n(1757),i=o._(n(7294)),a=r._(n(3935)),s=r._(n(9201)),c=n(3914),u=n(5494),f=n(869);n(1905);let l=n(1823),h=r._(n(4545)),p={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0};function d(t,e,n,r,o,i){let a=null==t?void 0:t.src;if(!t||t["data-loaded-src"]===a)return;t["data-loaded-src"]=a;let s="decode"in t?t.decode():Promise.resolve();s.catch(()=>{}).then(()=>{if(t.parentElement&&t.isConnected){if("empty"!==e&&o(!0),null==n?void 0:n.current){let e=new Event("load");Object.defineProperty(e,"target",{writable:!1,value:t});let r=!1,o=!1;n.current({...e,nativeEvent:e,currentTarget:t,target:t,isDefaultPrevented:()=>r,isPropagationStopped:()=>o,persist:()=>{},preventDefault:()=>{r=!0,e.preventDefault()},stopPropagation:()=>{o=!0,e.stopPropagation()}})}(null==r?void 0:r.current)&&r.current(t)}})}function v(t){let[e,n]=i.version.split(".",2),r=parseInt(e,10),o=parseInt(n,10);return r>18||18===r&&o>=3?{fetchPriority:t}:{fetchpriority:t}}let m=(0,i.forwardRef)((t,e)=>{let{src:n,srcSet:r,sizes:o,height:a,width:s,decoding:c,className:u,style:f,fetchPriority:l,placeholder:h,loading:p,unoptimized:m,fill:g,onLoadRef:y,onLoadingCompleteRef:b,setBlurComplete:w,setShowAltText:_,onLoad:x,onError:E,...P}=t;return i.default.createElement("img",{...P,...v(l),loading:p,width:s,height:a,decoding:c,"data-nimg":g?"fill":"1",className:u,style:f,sizes:o,srcSet:r,src:n,ref:(0,i.useCallback)(t=>{e&&("function"==typeof e?e(t):"object"==typeof e&&(e.current=t)),t&&(E&&(t.src=t.src),t.complete&&d(t,h,y,b,w,m))},[n,h,y,b,w,E,m,e]),onLoad:t=>{let e=t.currentTarget;d(e,h,y,b,w,m)},onError:t=>{_(!0),"empty"!==h&&w(!0),E&&E(t)}})});function g(t){let{isAppRouter:e,imgAttributes:n}=t,r={as:"image",imageSrcSet:n.srcSet,imageSizes:n.sizes,crossOrigin:n.crossOrigin,referrerPolicy:n.referrerPolicy,...v(n.fetchPriority)};return e&&a.default.preload?(a.default.preload(n.src,r),null):i.default.createElement(s.default,null,i.default.createElement("link",{key:"__nimg-"+n.src+n.srcSet+n.sizes,rel:"preload",href:n.srcSet?void 0:n.src,...r}))}let Image=(0,i.forwardRef)((t,e)=>{let n=(0,i.useContext)(l.RouterContext),r=(0,i.useContext)(f.ImageConfigContext),o=(0,i.useMemo)(()=>{let t=p||r||u.imageConfigDefault,e=[...t.deviceSizes,...t.imageSizes].sort((t,e)=>t-e),n=t.deviceSizes.sort((t,e)=>t-e);return{...t,allSizes:e,deviceSizes:n}},[r]),{onLoad:a,onLoadingComplete:s}=t,d=(0,i.useRef)(a);(0,i.useEffect)(()=>{d.current=a},[a]);let v=(0,i.useRef)(s);(0,i.useEffect)(()=>{v.current=s},[s]);let[y,b]=(0,i.useState)(!1),[w,_]=(0,i.useState)(!1),{props:x,meta:E}=(0,c.getImgProps)(t,{defaultLoader:h.default,imgConf:o,blurComplete:y,showAltText:w});return i.default.createElement(i.default.Fragment,null,i.default.createElement(m,{...x,unoptimized:E.unoptimized,placeholder:E.placeholder,fill:E.fill,onLoadRef:d,onLoadingCompleteRef:v,setBlurComplete:b,setShowAltText:_,ref:e}),E.priority?i.default.createElement(g,{isAppRouter:!n,imgAttributes:x}):null)});("function"==typeof e.default||"object"==typeof e.default&&null!==e.default)&&void 0===e.default.__esModule&&(Object.defineProperty(e.default,"__esModule",{value:!0}),Object.assign(e.default,e),t.exports=e.default)},1342:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t,e){for(var n in e)Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}(e,{noSSR:function(){return a},default:function(){return s}});let r=n(8754),o=(n(7294),r._(n(4304)));function i(t){return{default:(null==t?void 0:t.default)||t}}function a(t,e){return delete e.webpack,delete e.modules,t(e)}function s(t,e){let n=o.default,r={loading:t=>{let{error:e,isLoading:n,pastDelay:r}=t;return null}};t instanceof Promise?r.loader=()=>t:"function"==typeof t?r.loader=t:"object"==typeof t&&(r={...r,...t}),r={...r,...e};let s=r.loader;return(r.loadableGenerated&&(r={...r,...r.loadableGenerated},delete r.loadableGenerated),"boolean"!=typeof r.ssr||r.ssr)?n({...r,loader:()=>null!=s?s().then(i):Promise.resolve(i(()=>null))}):(delete r.webpack,delete r.modules,a(n,r))}("function"==typeof e.default||"object"==typeof e.default&&null!==e.default)&&void 0===e.default.__esModule&&(Object.defineProperty(e.default,"__esModule",{value:!0}),Object.assign(e.default,e),t.exports=e.default)},3914:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"getImgProps",{enumerable:!0,get:function(){return s}}),n(1905);let r=n(2393),o=n(5494);function i(t){return void 0!==t.default}function a(t){return void 0===t?t:"number"==typeof t?Number.isFinite(t)?t:NaN:"string"==typeof t&&/^[0-9]+$/.test(t)?parseInt(t,10):NaN}function s(t,e){var n;let s,c,u,{src:f,sizes:l,unoptimized:h=!1,priority:p=!1,loading:d,className:v,quality:m,width:g,height:y,fill:b=!1,style:w,onLoad:_,onLoadingComplete:x,placeholder:E="empty",blurDataURL:P,fetchPriority:M,layout:T,objectFit:F,objectPosition:S,lazyBoundary:k,lazyRoot:C,...A}=t,{imgConf:D,showAltText:O,blurComplete:L,defaultLoader:B}=e,I=D||o.imageConfigDefault;if("allSizes"in I)s=I;else{let t=[...I.deviceSizes,...I.imageSizes].sort((t,e)=>t-e),e=I.deviceSizes.sort((t,e)=>t-e);s={...I,allSizes:t,deviceSizes:e}}let j=A.loader||B;delete A.loader,delete A.srcSet;let R="__next_img_default"in j;if(R){if("custom"===s.loader)throw Error('Image with src "'+f+'" is missing "loader" prop.\nRead more: https://nextjs.org/docs/messages/next-image-missing-loader')}else{let t=j;j=e=>{let{config:n,...r}=e;return t(r)}}if(T){"fill"===T&&(b=!0);let t={intrinsic:{maxWidth:"100%",height:"auto"},responsive:{width:"100%",height:"auto"}}[T];t&&(w={...w,...t});let e={responsive:"100vw",fill:"100vw"}[T];e&&!l&&(l=e)}let N="",W=a(g),z=a(y);if("object"==typeof(n=f)&&(i(n)||void 0!==n.src)){let t=i(f)?f.default:f;if(!t.src)throw Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include src. Received "+JSON.stringify(t));if(!t.height||!t.width)throw Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include height and width. Received "+JSON.stringify(t));if(c=t.blurWidth,u=t.blurHeight,P=P||t.blurDataURL,N=t.src,!b){if(W||z){if(W&&!z){let e=W/t.width;z=Math.round(t.height*e)}else if(!W&&z){let e=z/t.height;W=Math.round(t.width*e)}}else W=t.width,z=t.height}}let U=!p&&("lazy"===d||void 0===d);(!(f="string"==typeof f?f:N)||f.startsWith("data:")||f.startsWith("blob:"))&&(h=!0,U=!1),s.unoptimized&&(h=!0),R&&f.endsWith(".svg")&&!s.dangerouslyAllowSVG&&(h=!0),p&&(M="high");let V=a(m),G=Object.assign(b?{position:"absolute",height:"100%",width:"100%",left:0,top:0,right:0,bottom:0,objectFit:F,objectPosition:S}:{},O?{}:{color:"transparent"},w),H=L||"empty"===E?null:"blur"===E?'url("data:image/svg+xml;charset=utf-8,'+(0,r.getImageBlurSvg)({widthInt:W,heightInt:z,blurWidth:c,blurHeight:u,blurDataURL:P||"",objectFit:G.objectFit})+'")':'url("'+E+'")',Y=H?{backgroundSize:G.objectFit||"cover",backgroundPosition:G.objectPosition||"50% 50%",backgroundRepeat:"no-repeat",backgroundImage:H}:{},J=function(t){let{config:e,src:n,unoptimized:r,width:o,quality:i,sizes:a,loader:s}=t;if(r)return{src:n,srcSet:void 0,sizes:void 0};let{widths:c,kind:u}=function(t,e,n){let{deviceSizes:r,allSizes:o}=t;if(n){let t=/(^|\s)(1?\d?\d)vw/g,e=[];for(let r;r=t.exec(n);r)e.push(parseInt(r[2]));if(e.length){let t=.01*Math.min(...e);return{widths:o.filter(e=>e>=r[0]*t),kind:"w"}}return{widths:o,kind:"w"}}if("number"!=typeof e)return{widths:r,kind:"w"};let i=[...new Set([e,2*e].map(t=>o.find(e=>e>=t)||o[o.length-1]))];return{widths:i,kind:"x"}}(e,o,a),f=c.length-1;return{sizes:a||"w"!==u?a:"100vw",srcSet:c.map((t,r)=>s({config:e,src:n,quality:i,width:t})+" "+("w"===u?t:r+1)+u).join(", "),src:s({config:e,src:n,quality:i,width:c[f]})}}({config:s,src:f,unoptimized:h,width:W,quality:V,sizes:l,loader:j}),Z={...A,loading:U?"lazy":d,fetchPriority:M,width:W,height:z,decoding:"async",className:v,style:{...G,...Y},sizes:J.sizes,srcSet:J.srcSet,src:J.src},q={unoptimized:h,priority:p,placeholder:E,fill:b};return{props:Z,meta:q}}},2393:function(t,e){"use strict";function n(t){let{widthInt:e,heightInt:n,blurWidth:r,blurHeight:o,blurDataURL:i,objectFit:a}=t,s=r?40*r:e,c=o?40*o:n,u=s&&c?"viewBox='0 0 "+s+" "+c+"'":"";return"%3Csvg xmlns='http://www.w3.org/2000/svg' "+u+"%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3CfeColorMatrix values='1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1' result='s'/%3E%3CfeFlood x='0' y='0' width='100%25' height='100%25'/%3E%3CfeComposite operator='out' in='s'/%3E%3CfeComposite in2='SourceGraphic'/%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3C/filter%3E%3Cimage width='100%25' height='100%25' x='0' y='0' preserveAspectRatio='"+(u?"none":"contain"===a?"xMidYMid":"cover"===a?"xMidYMid slice":"none")+"' style='filter: url(%23b);' href='"+i+"'/%3E%3C/svg%3E"}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"getImageBlurSvg",{enumerable:!0,get:function(){return n}})},645:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t,e){for(var n in e)Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}(e,{unstable_getImgProps:function(){return c},default:function(){return u}});let r=n(8754),o=n(3914),i=n(1905),a=n(3271),s=r._(n(4545)),c=t=>{(0,i.warnOnce)("Warning: unstable_getImgProps() is experimental and may change or be removed at any time. Use at your own risk.");let{props:e}=(0,o.getImgProps)(t,{defaultLoader:s.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0}});for(let[t,n]of Object.entries(e))void 0===n&&delete e[t];return{props:e}},u=a.Image},4545:function(t,e){"use strict";function n(t){let{config:e,src:n,width:r,quality:o}=t;return e.path+"?url="+encodeURIComponent(n)+"&w="+r+"&q="+(o||75)}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return r}}),n.__next_img_default=!0;let r=n},43:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"LoadableContext",{enumerable:!0,get:function(){return i}});let r=n(8754),o=r._(n(7294)),i=o.default.createContext(null)},4304:function(t,e,n){"use strict";/**
@copyright (c) 2017-present James Kyle <me@thejameskyle.com>
 MIT License
 Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:
 The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.
 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE
*/Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return p}});let r=n(8754),o=r._(n(7294)),i=n(43),a=[],s=[],c=!1;function u(t){let e=t(),n={loading:!0,loaded:null,error:null};return n.promise=e.then(t=>(n.loading=!1,n.loaded=t,t)).catch(t=>{throw n.loading=!1,n.error=t,t}),n}class f{promise(){return this._res.promise}retry(){this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};let{_res:t,_opts:e}=this;t.loading&&("number"==typeof e.delay&&(0===e.delay?this._state.pastDelay=!0:this._delay=setTimeout(()=>{this._update({pastDelay:!0})},e.delay)),"number"==typeof e.timeout&&(this._timeout=setTimeout(()=>{this._update({timedOut:!0})},e.timeout))),this._res.promise.then(()=>{this._update({}),this._clearTimeouts()}).catch(t=>{this._update({}),this._clearTimeouts()}),this._update({})}_update(t){this._state={...this._state,error:this._res.error,loaded:this._res.loaded,loading:this._res.loading,...t},this._callbacks.forEach(t=>t())}_clearTimeouts(){clearTimeout(this._delay),clearTimeout(this._timeout)}getCurrentValue(){return this._state}subscribe(t){return this._callbacks.add(t),()=>{this._callbacks.delete(t)}}constructor(t,e){this._loadFn=t,this._opts=e,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}}function l(t){return function(t,e){let n=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null},e),r=null;function a(){if(!r){let e=new f(t,n);r={getCurrentValue:e.getCurrentValue.bind(e),subscribe:e.subscribe.bind(e),retry:e.retry.bind(e),promise:e.promise.bind(e)}}return r.promise()}if(!c){let t=n.webpack?n.webpack():n.modules;t&&s.push(e=>{for(let n of t)if(e.includes(n))return a()})}function u(t,e){!function(){a();let t=o.default.useContext(i.LoadableContext);t&&Array.isArray(n.modules)&&n.modules.forEach(e=>{t(e)})}();let s=o.default.useSyncExternalStore(r.subscribe,r.getCurrentValue,r.getCurrentValue);return o.default.useImperativeHandle(e,()=>({retry:r.retry}),[]),o.default.useMemo(()=>{var e;return s.loading||s.error?o.default.createElement(n.loading,{isLoading:s.loading,pastDelay:s.pastDelay,timedOut:s.timedOut,error:s.error,retry:r.retry}):s.loaded?o.default.createElement((e=s.loaded)&&e.default?e.default:e,t):null},[t,s])}return u.preload=()=>a(),u.displayName="LoadableComponent",o.default.forwardRef(u)}(u,t)}function h(t,e){let n=[];for(;t.length;){let r=t.pop();n.push(r(e))}return Promise.all(n).then(()=>{if(t.length)return h(t,e)})}l.preloadAll=()=>new Promise((t,e)=>{h(a).then(t,e)}),l.preloadReady=t=>(void 0===t&&(t=[]),new Promise(e=>{let n=()=>(c=!0,e());h(s,t).then(n,n)})),window.__NEXT_PRELOADREADY=l.preloadReady;let p=l},1876:function(t){!function(){var e={675:function(t,e){"use strict";e.byteLength=function(t){var e=c(t),n=e[0],r=e[1];return(n+r)*3/4-r},e.toByteArray=function(t){var e,n,i=c(t),a=i[0],s=i[1],u=new o((a+s)*3/4-s),f=0,l=s>0?a-4:a;for(n=0;n<l;n+=4)e=r[t.charCodeAt(n)]<<18|r[t.charCodeAt(n+1)]<<12|r[t.charCodeAt(n+2)]<<6|r[t.charCodeAt(n+3)],u[f++]=e>>16&255,u[f++]=e>>8&255,u[f++]=255&e;return 2===s&&(e=r[t.charCodeAt(n)]<<2|r[t.charCodeAt(n+1)]>>4,u[f++]=255&e),1===s&&(e=r[t.charCodeAt(n)]<<10|r[t.charCodeAt(n+1)]<<4|r[t.charCodeAt(n+2)]>>2,u[f++]=e>>8&255,u[f++]=255&e),u},e.fromByteArray=function(t){for(var e,r=t.length,o=r%3,i=[],a=0,s=r-o;a<s;a+=16383)i.push(function(t,e,r){for(var o,i=[],a=e;a<r;a+=3)i.push(n[(o=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]))>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return i.join("")}(t,a,a+16383>s?s:a+16383));return 1===o?i.push(n[(e=t[r-1])>>2]+n[e<<4&63]+"=="):2===o&&i.push(n[(e=(t[r-2]<<8)+t[r-1])>>10]+n[e>>4&63]+n[e<<2&63]+"="),i.join("")};for(var n=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,s=i.length;a<s;++a)n[a]=i[a],r[i.charCodeAt(a)]=a;function c(t){var e=t.length;if(e%4>0)throw Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");-1===n&&(n=e);var r=n===e?0:4-n%4;return[n,r]}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},72:function(t,e,n){"use strict";/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var r=n(675),o=n(783),i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function a(t){if(t>2147483647)throw RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,s.prototype),e}function s(t,e,n){if("number"==typeof t){if("string"==typeof e)throw TypeError('The "string" argument must be of type string. Received type number');return f(t)}return c(t,e,n)}function c(t,e,n){if("string"==typeof t)return function(t,e){if(("string"!=typeof e||""===e)&&(e="utf8"),!s.isEncoding(e))throw TypeError("Unknown encoding: "+e);var n=0|p(t,e),r=a(n),o=r.write(t,e);return o!==n&&(r=r.slice(0,o)),r}(t,e);if(ArrayBuffer.isView(t))return l(t);if(null==t)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(k(t,ArrayBuffer)||t&&k(t.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(k(t,SharedArrayBuffer)||t&&k(t.buffer,SharedArrayBuffer)))return function(t,e,n){var r;if(e<0||t.byteLength<e)throw RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),s.prototype),r}(t,e,n);if("number"==typeof t)throw TypeError('The "value" argument must not be of type number. Received type number');var r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return s.from(r,e,n);var o=function(t){if(s.isBuffer(t)){var e,n=0|h(t.length),r=a(n);return 0===r.length||t.copy(r,0,0,n),r}return void 0!==t.length?"number"!=typeof t.length||(e=t.length)!=e?a(0):l(t):"Buffer"===t.type&&Array.isArray(t.data)?l(t.data):void 0}(t);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return s.from(t[Symbol.toPrimitive]("string"),e,n);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function u(t){if("number"!=typeof t)throw TypeError('"size" argument must be of type number');if(t<0)throw RangeError('The value "'+t+'" is invalid for option "size"')}function f(t){return u(t),a(t<0?0:0|h(t))}function l(t){for(var e=t.length<0?0:0|h(t.length),n=a(e),r=0;r<e;r+=1)n[r]=255&t[r];return n}function h(t){if(t>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|t}function p(t,e){if(s.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||k(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var n=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var o=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return M(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return F(t).length;default:if(o)return r?-1:M(t).length;e=(""+e).toLowerCase(),o=!0}}function d(t,e,n){var o,i,a=!1;if((void 0===e||e<0)&&(e=0),e>this.length||((void 0===n||n>this.length)&&(n=this.length),n<=0||(n>>>=0)<=(e>>>=0)))return"";for(t||(t="utf8");;)switch(t){case"hex":return function(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=e;i<n;++i)o+=C[t[i]];return o}(this,e,n);case"utf8":case"utf-8":return y(this,e,n);case"ascii":return function(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(127&t[o]);return r}(this,e,n);case"latin1":case"binary":return function(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}(this,e,n);case"base64":return o=e,i=n,0===o&&i===this.length?r.fromByteArray(this):r.fromByteArray(this.slice(o,i));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(t,e,n){for(var r=t.slice(e,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}(this,e,n);default:if(a)throw TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),a=!0}}function v(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function m(t,e,n,r,o){var i;if(0===t.length)return -1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),(i=n=+n)!=i&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return -1;n=t.length-1}else if(n<0){if(!o)return -1;n=0}if("string"==typeof e&&(e=s.from(e,r)),s.isBuffer(e))return 0===e.length?-1:g(t,e,n,r,o);if("number"==typeof e)return(e&=255,"function"==typeof Uint8Array.prototype.indexOf)?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):g(t,[e],n,r,o);throw TypeError("val must be string, number or Buffer")}function g(t,e,n,r,o){var i,a=1,s=t.length,c=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return -1;a=2,s/=2,c/=2,n/=2}function u(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(o){var f=-1;for(i=n;i<s;i++)if(u(t,i)===u(e,-1===f?0:i-f)){if(-1===f&&(f=i),i-f+1===c)return f*a}else -1!==f&&(i-=i-f),f=-1}else for(n+c>s&&(n=s-c),i=n;i>=0;i--){for(var l=!0,h=0;h<c;h++)if(u(t,i+h)!==u(e,h)){l=!1;break}if(l)return i}return -1}function y(t,e,n){n=Math.min(t.length,n);for(var r=[],o=e;o<n;){var i,a,s,c,u=t[o],f=null,l=u>239?4:u>223?3:u>191?2:1;if(o+l<=n)switch(l){case 1:u<128&&(f=u);break;case 2:(192&(i=t[o+1]))==128&&(c=(31&u)<<6|63&i)>127&&(f=c);break;case 3:i=t[o+1],a=t[o+2],(192&i)==128&&(192&a)==128&&(c=(15&u)<<12|(63&i)<<6|63&a)>2047&&(c<55296||c>57343)&&(f=c);break;case 4:i=t[o+1],a=t[o+2],s=t[o+3],(192&i)==128&&(192&a)==128&&(192&s)==128&&(c=(15&u)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(f=c)}null===f?(f=65533,l=1):f>65535&&(f-=65536,r.push(f>>>10&1023|55296),f=56320|1023&f),r.push(f),o+=l}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=4096));return n}(r)}function b(t,e,n){if(t%1!=0||t<0)throw RangeError("offset is not uint");if(t+e>n)throw RangeError("Trying to access beyond buffer length")}function w(t,e,n,r,o,i){if(!s.isBuffer(t))throw TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw RangeError('"value" argument is out of bounds');if(n+r>t.length)throw RangeError("Index out of range")}function _(t,e,n,r,o,i){if(n+r>t.length||n<0)throw RangeError("Index out of range")}function x(t,e,n,r,i){return e=+e,n>>>=0,i||_(t,e,n,4,34028234663852886e22,-34028234663852886e22),o.write(t,e,n,r,23,4),n+4}function E(t,e,n,r,i){return e=+e,n>>>=0,i||_(t,e,n,8,17976931348623157e292,-17976931348623157e292),o.write(t,e,n,r,52,8),n+8}e.Buffer=s,e.SlowBuffer=function(t){return+t!=t&&(t=0),s.alloc(+t)},e.INSPECT_MAX_BYTES=50,e.kMaxLength=2147483647,s.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(t,e,n){return c(t,e,n)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(t,e,n){return(u(t),t<=0)?a(t):void 0!==e?"string"==typeof n?a(t).fill(e,n):a(t).fill(e):a(t)},s.allocUnsafe=function(t){return f(t)},s.allocUnsafeSlow=function(t){return f(t)},s.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==s.prototype},s.compare=function(t,e){if(k(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),k(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(t)||!s.isBuffer(e))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var n=t.length,r=e.length,o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},s.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(t,e){if(!Array.isArray(t))throw TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return s.alloc(0);if(void 0===e)for(n=0,e=0;n<t.length;++n)e+=t[n].length;var n,r=s.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){var i=t[n];if(k(i,Uint8Array)&&(i=s.from(i)),!s.isBuffer(i))throw TypeError('"list" argument must be an Array of Buffers');i.copy(r,o),o+=i.length}return r},s.byteLength=p,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)v(this,e,e+1);return this},s.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)v(this,e,e+3),v(this,e+1,e+2);return this},s.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)v(this,e,e+7),v(this,e+1,e+6),v(this,e+2,e+5),v(this,e+3,e+4);return this},s.prototype.toString=function(){var t=this.length;return 0===t?"":0==arguments.length?y(this,0,t):d.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(t){if(!s.isBuffer(t))throw TypeError("Argument must be a Buffer");return this===t||0===s.compare(this,t)},s.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"},i&&(s.prototype[i]=s.prototype.inspect),s.prototype.compare=function(t,e,n,r,o){if(k(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(t))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return -1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,o>>>=0,this===t)return 0;for(var i=o-r,a=n-e,c=Math.min(i,a),u=this.slice(r,o),f=t.slice(e,n),l=0;l<c;++l)if(u[l]!==f[l]){i=u[l],a=f[l];break}return i<a?-1:a<i?1:0},s.prototype.includes=function(t,e,n){return -1!==this.indexOf(t,e,n)},s.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},s.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},s.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else if(isFinite(e))e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var o,i,a,s,c,u,f,l,h,p,d,v,m=this.length-e;if((void 0===n||n>m)&&(n=m),t.length>0&&(n<0||e<0)||e>this.length)throw RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var g=!1;;)switch(r){case"hex":return function(t,e,n,r){n=Number(n)||0;var o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=e.length;r>i/2&&(r=i/2);for(var a=0;a<r;++a){var s=parseInt(e.substr(2*a,2),16);if(s!=s)break;t[n+a]=s}return a}(this,t,e,n);case"utf8":case"utf-8":return c=e,u=n,S(M(t,this.length-c),this,c,u);case"ascii":return f=e,l=n,S(T(t),this,f,l);case"latin1":case"binary":return o=this,i=t,a=e,s=n,S(T(i),o,a,s);case"base64":return h=e,p=n,S(F(t),this,h,p);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return d=e,v=n,S(function(t,e){for(var n,r,o=[],i=0;i<t.length&&!((e-=2)<0);++i)r=(n=t.charCodeAt(i))>>8,o.push(n%256),o.push(r);return o}(t,this.length-d),this,d,v);default:if(g)throw TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),g=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.slice=function(t,e){var n=this.length;t=~~t,e=void 0===e?n:~~e,t<0?(t+=n)<0&&(t=0):t>n&&(t=n),e<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);var r=this.subarray(t,e);return Object.setPrototypeOf(r,s.prototype),r},s.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||b(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r},s.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||b(t,e,this.length);for(var r=this[t+--e],o=1;e>0&&(o*=256);)r+=this[t+--e]*o;return r},s.prototype.readUInt8=function(t,e){return t>>>=0,e||b(t,1,this.length),this[t]},s.prototype.readUInt16LE=function(t,e){return t>>>=0,e||b(t,2,this.length),this[t]|this[t+1]<<8},s.prototype.readUInt16BE=function(t,e){return t>>>=0,e||b(t,2,this.length),this[t]<<8|this[t+1]},s.prototype.readUInt32LE=function(t,e){return t>>>=0,e||b(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},s.prototype.readUInt32BE=function(t,e){return t>>>=0,e||b(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},s.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||b(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*e)),r},s.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||b(t,e,this.length);for(var r=e,o=1,i=this[t+--r];r>0&&(o*=256);)i+=this[t+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*e)),i},s.prototype.readInt8=function(t,e){return(t>>>=0,e||b(t,1,this.length),128&this[t])?-((255-this[t]+1)*1):this[t]},s.prototype.readInt16LE=function(t,e){t>>>=0,e||b(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(t,e){t>>>=0,e||b(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(t,e){return t>>>=0,e||b(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},s.prototype.readInt32BE=function(t,e){return t>>>=0,e||b(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},s.prototype.readFloatLE=function(t,e){return t>>>=0,e||b(t,4,this.length),o.read(this,t,!0,23,4)},s.prototype.readFloatBE=function(t,e){return t>>>=0,e||b(t,4,this.length),o.read(this,t,!1,23,4)},s.prototype.readDoubleLE=function(t,e){return t>>>=0,e||b(t,8,this.length),o.read(this,t,!0,52,8)},s.prototype.readDoubleBE=function(t,e){return t>>>=0,e||b(t,8,this.length),o.read(this,t,!1,52,8)},s.prototype.writeUIntLE=function(t,e,n,r){if(t=+t,e>>>=0,n>>>=0,!r){var o=Math.pow(2,8*n)-1;w(this,t,e,n,o,0)}var i=1,a=0;for(this[e]=255&t;++a<n&&(i*=256);)this[e+a]=t/i&255;return e+n},s.prototype.writeUIntBE=function(t,e,n,r){if(t=+t,e>>>=0,n>>>=0,!r){var o=Math.pow(2,8*n)-1;w(this,t,e,n,o,0)}var i=n-1,a=1;for(this[e+i]=255&t;--i>=0&&(a*=256);)this[e+i]=t/a&255;return e+n},s.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||w(this,t,e,1,255,0),this[e]=255&t,e+1},s.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||w(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||w(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||w(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},s.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||w(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var o=Math.pow(2,8*n-1);w(this,t,e,n,o-1,-o)}var i=0,a=1,s=0;for(this[e]=255&t;++i<n&&(a*=256);)t<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(t/a>>0)-s&255;return e+n},s.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var o=Math.pow(2,8*n-1);w(this,t,e,n,o-1,-o)}var i=n-1,a=1,s=0;for(this[e+i]=255&t;--i>=0&&(a*=256);)t<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(t/a>>0)-s&255;return e+n},s.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||w(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},s.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||w(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||w(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||w(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},s.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||w(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeFloatLE=function(t,e,n){return x(this,t,e,!0,n)},s.prototype.writeFloatBE=function(t,e,n){return x(this,t,e,!1,n)},s.prototype.writeDoubleLE=function(t,e,n){return E(this,t,e,!0,n)},s.prototype.writeDoubleBE=function(t,e,n){return E(this,t,e,!1,n)},s.prototype.copy=function(t,e,n,r){if(!s.isBuffer(t))throw TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n||0===t.length||0===this.length)return 0;if(e<0)throw RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw RangeError("Index out of range");if(r<0)throw RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var o=r-n;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(e,n,r);else if(this===t&&n<e&&e<r)for(var i=o-1;i>=0;--i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,r),e);return o},s.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw TypeError("encoding must be a string");if("string"==typeof r&&!s.isEncoding(r))throw TypeError("Unknown encoding: "+r);if(1===t.length){var o,i=t.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(t=i)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw RangeError("Out of range index");if(n<=e)return this;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var a=s.isBuffer(t)?t:s.from(t,r),c=a.length;if(0===c)throw TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<n-e;++o)this[o+e]=a[o%c]}return this};var P=/[^+/0-9A-Za-z-_]/g;function M(t,e){e=e||1/0;for(var n,r=t.length,o=null,i=[],a=0;a<r;++a){if((n=t.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319||a+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=(o-55296<<10|n-56320)+65536}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else if(n<1114112){if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}else throw Error("Invalid code point")}return i}function T(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}function F(t){return r.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(P,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function S(t,e,n,r){for(var o=0;o<r&&!(o+n>=e.length)&&!(o>=t.length);++o)e[o+n]=t[o];return o}function k(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}var C=function(){for(var t="0123456789abcdef",e=Array(256),n=0;n<16;++n)for(var r=16*n,o=0;o<16;++o)e[r+o]=t[n]+t[o];return e}()},783:function(t,e){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */e.read=function(t,e,n,r,o){var i,a,s=8*o-r-1,c=(1<<s)-1,u=c>>1,f=-7,l=n?o-1:0,h=n?-1:1,p=t[e+l];for(l+=h,i=p&(1<<-f)-1,p>>=-f,f+=s;f>0;i=256*i+t[e+l],l+=h,f-=8);for(a=i&(1<<-f)-1,i>>=-f,f+=r;f>0;a=256*a+t[e+l],l+=h,f-=8);if(0===i)i=1-u;else{if(i===c)return a?NaN:(p?-1:1)*(1/0);a+=Math.pow(2,r),i-=u}return(p?-1:1)*a*Math.pow(2,i-r)},e.write=function(t,e,n,r,o,i){var a,s,c,u=8*i-o-1,f=(1<<u)-1,l=f>>1,h=23===o?5960464477539062e-23:0,p=r?0:i-1,d=r?1:-1,v=e<0||0===e&&1/e<0?1:0;for(isNaN(e=Math.abs(e))||e===1/0?(s=isNaN(e)?1:0,a=f):(a=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-a))<1&&(a--,c*=2),a+l>=1?e+=h/c:e+=h*Math.pow(2,1-l),e*c>=2&&(a++,c/=2),a+l>=f?(s=0,a=f):a+l>=1?(s=(e*c-1)*Math.pow(2,o),a+=l):(s=e*Math.pow(2,l-1)*Math.pow(2,o),a=0));o>=8;t[n+p]=255&s,p+=d,s/=256,o-=8);for(a=a<<o|s,u+=o;u>0;t[n+p]=255&a,p+=d,a/=256,u-=8);t[n+p-d]|=128*v}}},n={};function r(t){var o=n[t];if(void 0!==o)return o.exports;var i=n[t]={exports:{}},a=!0;try{e[t](i,i.exports,r),a=!1}finally{a&&delete n[t]}return i.exports}r.ab="//";var o=r(72);t.exports=o}()},7663:function(t){!function(){var e={229:function(t){var e,n,r,o=t.exports={};function i(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===i||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:i}catch(t){e=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var c=[],u=!1,f=-1;function l(){u&&r&&(u=!1,r.length?c=r.concat(c):f=-1,c.length&&h())}function h(){if(!u){var t=s(l);u=!0;for(var e=c.length;e;){for(r=c,c=[];++f<e;)r&&r[f].run();f=-1,e=c.length}r=null,u=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function d(){}o.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||u||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=d,o.addListener=d,o.once=d,o.off=d,o.removeListener=d,o.removeAllListeners=d,o.emit=d,o.prependListener=d,o.prependOnceListener=d,o.listeners=function(t){return[]},o.binding=function(t){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}},n={};function r(t){var o=n[t];if(void 0!==o)return o.exports;var i=n[t]={exports:{}},a=!0;try{e[t](i,i.exports,r),a=!1}finally{a&&delete n[t]}return i.exports}r.ab="//";var o=r(229);t.exports=o}()},5152:function(t,e,n){t.exports=n(1342)},9008:function(t,e,n){t.exports=n(9201)},5675:function(t,e,n){t.exports=n(645)},1163:function(t,e,n){t.exports=n(9974)},8662:function(t,e,n){"use strict";var r=n(7294);let o=r.forwardRef(function({title:t,titleId:e,...n},o){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":e},n),t?r.createElement("title",{id:e},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.26 10.147a60.436 60.436 0 00-.491 6.347A48.627 48.627 0 0112 20.904a48.627 48.627 0 018.232-4.41 60.46 60.46 0 00-.491-6.347m-15.482 0a50.57 50.57 0 00-2.658-.813A59.905 59.905 0 0112 3.493a59.902 59.902 0 0110.399 5.84c-.896.248-1.783.52-2.658.814m-15.482 0A50.697 50.697 0 0112 13.489a50.702 50.702 0 017.74-3.342M6.75 15a.75.75 0 100-1.5.75.75 0 000 1.5zm0 0v-3.675A55.378 55.378 0 0112 8.443m-7.007 11.55A5.981 5.981 0 006.75 15.75v-1.5"}))});e.Z=o},5133:function(t,e,n){"use strict";var r=n(7294);let o=r.forwardRef(function({title:t,titleId:e,...n},o){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":e},n),t?r.createElement("title",{id:e},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"}))});e.Z=o},1902:function(t,e,n){"use strict";var r=n(7294);let o=r.forwardRef(function({title:t,titleId:e,...n},o){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":e},n),t?r.createElement("title",{id:e},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"}))});e.Z=o},2364:function(t,e,n){"use strict";var r=n(7294);let o=r.forwardRef(function({title:t,titleId:e,...n},o){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":e},n),t?r.createElement("title",{id:e},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 21h19.5m-18-18v18m10.5-18v18m6-13.5V21M6.75 6.75h.75m-.75 3h.75m-.75 3h.75m3-6h.75m-.75 3h.75m-.75 3h.75M6.75 21v-3.375c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21M3 3h12m-.75 4.5H21m-3.75 3.75h.008v.008h-.008v-.008zm0 3h.008v.008h-.008v-.008zm0 3h.008v.008h-.008v-.008z"}))});e.Z=o},9871:function(t,e,n){"use strict";var r=n(7294);let o=r.forwardRef(function({title:t,titleId:e,...n},o){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":e},n),t?r.createElement("title",{id:e},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5"}))});e.Z=o},3245:function(t,e,n){"use strict";var r=n(7294);let o=r.forwardRef(function({title:t,titleId:e,...n},o){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":e},n),t?r.createElement("title",{id:e},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"}))});e.Z=o},8362:function(t,e,n){"use strict";var r=n(7294);let o=r.forwardRef(function({title:t,titleId:e,...n},o){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":e},n),t?r.createElement("title",{id:e},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 1.5H8.25A2.25 2.25 0 006 3.75v16.5a2.25 2.25 0 002.25 2.25h7.5A2.25 2.25 0 0018 20.25V3.75a2.25 2.25 0 00-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3"}))});e.Z=o},5350:function(t,e,n){"use strict";var r=n(7294);let o=r.forwardRef(function({title:t,titleId:e,...n},o){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":e},n),t?r.createElement("title",{id:e},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75"}))});e.Z=o},6301:function(t,e,n){"use strict";var r=n(7294);let o=r.forwardRef(function({title:t,titleId:e,...n},o){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":e},n),t?r.createElement("title",{id:e},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 3v1.5M3 21v-6m0 0l2.77-.693a9 9 0 016.208.682l.108.054a9 9 0 006.086.71l3.114-.732a48.524 48.524 0 01-.005-10.499l-3.11.732a9 9 0 01-6.085-.711l-.108-.054a9 9 0 00-6.208-.682L3 4.5M3 15V4.5"}))});e.Z=o},4912:function(t,e,n){"use strict";var r=n(7294);let o=r.forwardRef(function({title:t,titleId:e,...n},o){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":e},n),t?r.createElement("title",{id:e},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 6.75V15m6-6v8.25m.503 3.498l4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 00-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0z"}))});e.Z=o},6850:function(t,e,n){"use strict";var r=n(7294);let o=r.forwardRef(function({title:t,titleId:e,...n},o){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":e},n),t?r.createElement("title",{id:e},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"}),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"}))});e.Z=o},5083:function(t,e,n){"use strict";var r=n(7294);let o=r.forwardRef(function({title:t,titleId:e,...n},o){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":e},n),t?r.createElement("title",{id:e},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 001.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 001.423 1.423l1.183.394-1.183.394a2.25 2.25 0 00-1.423 1.423z"}))});e.Z=o},4727:function(t,e,n){"use strict";var r=n(7294);let o=r.forwardRef(function({title:t,titleId:e,...n},o){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":e},n),t?r.createElement("title",{id:e},t):null,r.createElement("path",{fillRule:"evenodd",d:"M14.615 1.595a.75.75 0 01.359.852L12.982 9.75h7.268a.75.75 0 01.548 1.262l-10.5 11.25a.75.75 0 01-1.272-.71l1.992-7.302H3.75a.75.75 0 01-.548-1.262l10.5-11.25a.75.75 0 01.913-.143z",clipRule:"evenodd"}))});e.Z=o},8957:function(t,e,n){"use strict";var r=n(7294);let o=r.forwardRef(function({title:t,titleId:e,...n},o){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":e},n),t?r.createElement("title",{id:e},t):null,r.createElement("path",{fillRule:"evenodd",d:"M11.47 7.72a.75.75 0 011.06 0l7.5 7.5a.75.75 0 11-1.06 1.06L12 9.31l-6.97 6.97a.75.75 0 01-1.06-1.06l7.5-7.5z",clipRule:"evenodd"}))});e.Z=o}}]);